/**
 * Suppress closure compiler errors about unknown 'process' variable
 * @fileoverview
 * @suppress {undefinedVars}
 */
System.register([], function(exports_1, context_1) {
    "use strict";
    var __moduleName = context_1 && context_1.id;
    var zoneSymbol, _global, isWebWorker, isNode, isBrowser, EVENT_TASKS, ADD_EVENT_LISTENER, REMOVE_EVENT_LISTENER, SYMBOL_ADD_EVENT_LISTENER, SYMBOL_REMOVE_EVENT_LISTENER, originalInstanceKey;
    function bindArguments(args, source) {
        for (var i = args.length - 1; i >= 0; i--) {
            if (typeof args[i] === 'function') {
                args[i] = Zone.current.wrap(args[i], source + '_' + i);
            }
        }
        return args;
    }
    exports_1("bindArguments", bindArguments);
    function patchPrototype(prototype, fnNames) {
        var source = prototype.constructor['name'];
        for (var i = 0; i < fnNames.length; i++) {
            var name = fnNames[i];
            var delegate = prototype[name];
            if (delegate) {
                prototype[name] = (function (delegate) {
                    return function () {
                        return delegate.apply(this, bindArguments(arguments, source + '.' + name));
                    };
                })(delegate);
            }
        }
    }
    exports_1("patchPrototype", patchPrototype);
    function patchProperty(obj, prop) {
        var desc = Object.getOwnPropertyDescriptor(obj, prop) || {
            enumerable: true,
            configurable: true
        };
        // A property descriptor cannot have getter/setter and be writable
        // deleting the writable and value properties avoids this error:
        //
        // TypeError: property descriptors must not specify a value or be writable when a
        // getter or setter has been specified
        delete desc.writable;
        delete desc.value;
        // substr(2) cuz 'onclick' -> 'click', etc
        var eventName = prop.substr(2);
        var _prop = '_' + prop;
        desc.set = function (fn) {
            if (this[_prop]) {
                this.removeEventListener(eventName, this[_prop]);
            }
            if (typeof fn === 'function') {
                var wrapFn = function (event) {
                    var result;
                    result = fn.apply(this, arguments);
                    if (result != undefined && !result)
                        event.preventDefault();
                };
                this[_prop] = wrapFn;
                this.addEventListener(eventName, wrapFn, false);
            }
            else {
                this[_prop] = null;
            }
        };
        desc.get = function () {
            return this[_prop];
        };
        Object.defineProperty(obj, prop, desc);
    }
    exports_1("patchProperty", patchProperty);
    function patchOnProperties(obj, properties) {
        var onProperties = [];
        for (var prop in obj) {
            if (prop.substr(0, 2) == 'on') {
                onProperties.push(prop);
            }
        }
        for (var j = 0; j < onProperties.length; j++) {
            patchProperty(obj, onProperties[j]);
        }
        if (properties) {
            for (var i = 0; i < properties.length; i++) {
                patchProperty(obj, 'on' + properties[i]);
            }
        }
    }
    exports_1("patchOnProperties", patchOnProperties);
    function findExistingRegisteredTask(target, handler, name, capture, remove) {
        var eventTasks = target[EVENT_TASKS];
        if (eventTasks) {
            for (var i = 0; i < eventTasks.length; i++) {
                var eventTask = eventTasks[i];
                var data = eventTask.data;
                if (data.handler === handler
                    && data.useCapturing === capture
                    && data.eventName === name) {
                    if (remove) {
                        eventTasks.splice(i, 1);
                    }
                    return eventTask;
                }
            }
        }
        return null;
    }
    function attachRegisteredEvent(target, eventTask) {
        var eventTasks = target[EVENT_TASKS];
        if (!eventTasks) {
            eventTasks = target[EVENT_TASKS] = [];
        }
        eventTasks.push(eventTask);
    }
    function scheduleEventListener(eventTask) {
        var meta = eventTask.data;
        attachRegisteredEvent(meta.target, eventTask);
        return meta.target[SYMBOL_ADD_EVENT_LISTENER](meta.eventName, eventTask.invoke, meta.useCapturing);
    }
    function cancelEventListener(eventTask) {
        var meta = eventTask.data;
        findExistingRegisteredTask(meta.target, eventTask.invoke, meta.eventName, meta.useCapturing, true);
        meta.target[SYMBOL_REMOVE_EVENT_LISTENER](meta.eventName, eventTask.invoke, meta.useCapturing);
    }
    function zoneAwareAddEventListener(self, args) {
        var eventName = args[0];
        var handler = args[1];
        var useCapturing = args[2] || false;
        // - Inside a Web Worker, `this` is undefined, the context is `global`
        // - When `addEventListener` is called on the global context in strict mode, `this` is undefined
        // see https://github.com/angular/zone.js/issues/190
        var target = self || _global;
        var delegate = null;
        if (typeof handler == 'function') {
            delegate = handler;
        }
        else if (handler && handler.handleEvent) {
            delegate = function (event) { return handler.handleEvent(event); };
        }
        // Ignore special listeners of IE11 & Edge dev tools, see https://github.com/angular/zone.js/issues/150
        if (!delegate || handler && handler.toString() === "[object FunctionWrapper]") {
            return target[SYMBOL_ADD_EVENT_LISTENER](eventName, handler, useCapturing);
        }
        var eventTask = findExistingRegisteredTask(target, handler, eventName, useCapturing, false);
        if (eventTask) {
            // we already registered, so this will have noop.
            return target[SYMBOL_ADD_EVENT_LISTENER](eventName, eventTask.invoke, useCapturing);
        }
        var zone = Zone.current;
        var source = target.constructor['name'] + '.addEventListener:' + eventName;
        var data = {
            target: target,
            eventName: eventName,
            name: eventName,
            useCapturing: useCapturing,
            handler: handler
        };
        zone.scheduleEventTask(source, delegate, data, scheduleEventListener, cancelEventListener);
    }
    function zoneAwareRemoveEventListener(self, args) {
        var eventName = args[0];
        var handler = args[1];
        var useCapturing = args[2] || false;
        // - Inside a Web Worker, `this` is undefined, the context is `global`
        // - When `addEventListener` is called on the global context in strict mode, `this` is undefined
        // see https://github.com/angular/zone.js/issues/190
        var target = self || _global;
        var eventTask = findExistingRegisteredTask(target, handler, eventName, useCapturing, true);
        if (eventTask) {
            eventTask.zone.cancelTask(eventTask);
        }
        else {
            target[SYMBOL_REMOVE_EVENT_LISTENER](eventName, handler, useCapturing);
        }
    }
    function patchEventTargetMethods(obj) {
        if (obj && obj.addEventListener) {
            patchMethod(obj, ADD_EVENT_LISTENER, function () { return zoneAwareAddEventListener; });
            patchMethod(obj, REMOVE_EVENT_LISTENER, function () { return zoneAwareRemoveEventListener; });
            return true;
        }
        else {
            return false;
        }
    }
    exports_1("patchEventTargetMethods", patchEventTargetMethods);
    // wrap some native API on `window`
    function patchClass(className) {
        var OriginalClass = _global[className];
        if (!OriginalClass)
            return;
        _global[className] = function () {
            var a = bindArguments(arguments, className);
            switch (a.length) {
                case 0:
                    this[originalInstanceKey] = new OriginalClass();
                    break;
                case 1:
                    this[originalInstanceKey] = new OriginalClass(a[0]);
                    break;
                case 2:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1]);
                    break;
                case 3:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1], a[2]);
                    break;
                case 4:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1], a[2], a[3]);
                    break;
                default: throw new Error('Arg list too long.');
            }
        };
        var instance = new OriginalClass(function () { });
        var prop;
        for (prop in instance) {
            (function (prop) {
                if (typeof instance[prop] === 'function') {
                    _global[className].prototype[prop] = function () {
                        return this[originalInstanceKey][prop].apply(this[originalInstanceKey], arguments);
                    };
                }
                else {
                    Object.defineProperty(_global[className].prototype, prop, {
                        set: function (fn) {
                            if (typeof fn === 'function') {
                                this[originalInstanceKey][prop] = Zone.current.wrap(fn, className + '.' + prop);
                            }
                            else {
                                this[originalInstanceKey][prop] = fn;
                            }
                        },
                        get: function () {
                            return this[originalInstanceKey][prop];
                        }
                    });
                }
            }(prop));
        }
        for (prop in OriginalClass) {
            if (prop !== 'prototype' && OriginalClass.hasOwnProperty(prop)) {
                _global[className][prop] = OriginalClass[prop];
            }
        }
    }
    exports_1("patchClass", patchClass);
    function createNamedFn(name, delegate) {
        try {
            return (Function('f', "return function " + name + "(){return f(this, arguments)}"))(delegate);
        }
        catch (e) {
            // if we fail, we must be CSP, just return delegate.
            return function () {
                return delegate(this, arguments);
            };
        }
    }
    exports_1("createNamedFn", createNamedFn);
    function patchMethod(target, name, patchFn) {
        var proto = target;
        while (proto && !proto.hasOwnProperty(name)) {
            proto = Object.getPrototypeOf(proto);
        }
        if (!proto && target[name]) {
            // somehow we did not find it, but we can see it. This happens on IE for Window properties.
            proto = target;
        }
        var delegateName = zoneSymbol(name);
        var delegate;
        if (proto && !(delegate = proto[delegateName])) {
            delegate = proto[delegateName] = proto[name];
            proto[name] = createNamedFn(name, patchFn(delegate, delegateName, name));
        }
        return delegate;
    }
    exports_1("patchMethod", patchMethod);
    return {
        setters:[],
        execute: function() {
            exports_1("zoneSymbol", zoneSymbol = Zone['__symbol__']);
            _global = typeof window == 'undefined' ? global : window;
            ;
            ;
            exports_1("isWebWorker", isWebWorker = (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope));
            exports_1("isNode", isNode = (typeof process !== 'undefined' && {}.toString.call(process) === '[object process]'));
            exports_1("isBrowser", isBrowser = !isNode && !isWebWorker && !!(window && window['HTMLElement']));
            ;
            ;
            EVENT_TASKS = zoneSymbol('eventTasks');
            ADD_EVENT_LISTENER = 'addEventListener';
            REMOVE_EVENT_LISTENER = 'removeEventListener';
            SYMBOL_ADD_EVENT_LISTENER = zoneSymbol(ADD_EVENT_LISTENER);
            SYMBOL_REMOVE_EVENT_LISTENER = zoneSymbol(REMOVE_EVENT_LISTENER);
            ;
            originalInstanceKey = zoneSymbol('originalInstance');
            ;
        }
    }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpYy9ub2RlX21vZHVsZXMvem9uZS5qcy9saWIvYnJvd3Nlci91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHOzs7O1FBSVEsVUFBVSxFQUNmLE9BQU8sRUEwQkYsV0FBVyxFQUdYLE1BQU0sRUFHTixTQUFTLEVBbUVkLFdBQVcsRUFDWCxrQkFBa0IsRUFDbEIscUJBQXFCLEVBQ3JCLHlCQUF5QixFQUN6Qiw0QkFBNEIsRUFxSDlCLG1CQUFtQjtJQTFOdkIsdUJBQThCLElBQVcsRUFBRSxNQUFjO1FBQ3ZELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMxQyxFQUFFLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUNsQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDekQsQ0FBQztRQUNILENBQUM7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQVBELHlDQU9DLENBQUE7SUFFRCx3QkFBK0IsU0FBUyxFQUFFLE9BQU87UUFDL0MsSUFBSSxNQUFNLEdBQUcsU0FBUyxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMzQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUN4QyxJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEIsSUFBSSxRQUFRLEdBQUcsU0FBUyxDQUFDLElB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ZV9tb2R1bGVzL3pvbmUuanMvbGliL2Jyb3dzZXIvdXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFN1cHByZXNzIGNsb3N1cmUgY29tcGlsZXIgZXJyb3JzIGFib3V0IHVua25vd24gJ3Byb2Nlc3MnIHZhcmlhYmxlXG4gKiBAZmlsZW92ZXJ2aWV3XG4gKiBAc3VwcHJlc3Mge3VuZGVmaW5lZFZhcnN9XG4gKi9cblxuLy8gSGFjayBzaW5jZSBUeXBlU2NyaXB0IGlzbid0IGNvbXBpbGluZyB0aGlzIGZvciBhIHdvcmtlci5cbmRlY2xhcmUgdmFyIFdvcmtlckdsb2JhbFNjb3BlO1xuZXhwb3J0IHZhciB6b25lU3ltYm9sOiAobmFtZTogc3RyaW5nKSA9PiBzdHJpbmcgPSBab25lWydfX3N5bWJvbF9fJ107XG5jb25zdCBfZ2xvYmFsID0gdHlwZW9mIHdpbmRvdyA9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHdpbmRvdztcblxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRBcmd1bWVudHMoYXJnczogYW55W10sIHNvdXJjZTogc3RyaW5nKTogYW55W10ge1xuICBmb3IgKHZhciBpID0gYXJncy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGlmICh0eXBlb2YgYXJnc1tpXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYXJnc1tpXSA9IFpvbmUuY3VycmVudC53cmFwKGFyZ3NbaV0sIHNvdXJjZSArICdfJyArIGkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYXJncztcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXRjaFByb3RvdHlwZShwcm90b3R5cGUsIGZuTmFtZXMpIHtcbiAgdmFyIHNvdXJjZSA9IHByb3RvdHlwZS5jb25zdHJ1Y3RvclsnbmFtZSddO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGZuTmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmFtZSA9IGZuTmFtZXNbaV07XG4gICAgdmFyIGRlbGVnYXRlID0gcHJvdG90eXBlW25hbWVdO1xuICAgIGlmIChkZWxlZ2F0ZSkge1xuICAgICAgcHJvdG90eXBlW25hbWVdID0gKChkZWxlZ2F0ZTogRnVuY3Rpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5hcHBseSh0aGlzLCBiaW5kQXJndW1lbnRzKDxhbnk+YXJndW1lbnRzLCBzb3VyY2UgKyAnLicgKyBuYW1lKSk7XG4gICAgICAgIH07XG4gICAgICB9KShkZWxlZ2F0ZSk7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgdmFyIGlzV2ViV29ya2VyOiBib29sZWFuID1cbiAgICAodHlwZW9mIFdvcmtlckdsb2JhbFNjb3BlICE9PSAndW5kZWZpbmVkJyAmJiBzZWxmIGluc3RhbmNlb2YgV29ya2VyR2xvYmFsU2NvcGUpO1xuXG5leHBvcnQgdmFyIGlzTm9kZTogYm9vbGVhbiA9XG4gICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKTtcblxuZXhwb3J0IHZhciBpc0Jyb3dzZXI6IGJvb2xlYW4gPVxuICAgICFpc05vZGUgJiYgIWlzV2ViV29ya2VyICYmICEhKHdpbmRvdyAmJiB3aW5kb3dbJ0hUTUxFbGVtZW50J10pO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBwYXRjaFByb3BlcnR5KG9iaiwgcHJvcCkge1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBwcm9wKSB8fCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfTtcblxuICAvLyBBIHByb3BlcnR5IGRlc2NyaXB0b3IgY2Fubm90IGhhdmUgZ2V0dGVyL3NldHRlciBhbmQgYmUgd3JpdGFibGVcbiAgLy8gZGVsZXRpbmcgdGhlIHdyaXRhYmxlIGFuZCB2YWx1ZSBwcm9wZXJ0aWVzIGF2b2lkcyB0aGlzIGVycm9yOlxuICAvL1xuICAvLyBUeXBlRXJyb3I6IHByb3BlcnR5IGRlc2NyaXB0b3JzIG11c3Qgbm90IHNwZWNpZnkgYSB2YWx1ZSBvciBiZSB3cml0YWJsZSB3aGVuIGFcbiAgLy8gZ2V0dGVyIG9yIHNldHRlciBoYXMgYmVlbiBzcGVjaWZpZWRcbiAgZGVsZXRlIGRlc2Mud3JpdGFibGU7XG4gIGRlbGV0ZSBkZXNjLnZhbHVlO1xuXG4gIC8vIHN1YnN0cigyKSBjdXogJ29uY2xpY2snIC0+ICdjbGljaycsIGV0Y1xuICB2YXIgZXZlbnROYW1lID0gcHJvcC5zdWJzdHIoMik7XG4gIHZhciBfcHJvcCA9ICdfJyArIHByb3A7XG5cbiAgZGVzYy5zZXQgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICBpZiAodGhpc1tfcHJvcF0pIHtcbiAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHRoaXNbX3Byb3BdKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YXIgd3JhcEZuID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIHJlc3VsdCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCAhPSB1bmRlZmluZWQgJiYgIXJlc3VsdClcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfTtcblxuICAgICAgdGhpc1tfcHJvcF0gPSB3cmFwRm47XG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCB3cmFwRm4sIGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpc1tfcHJvcF0gPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBkZXNjLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpc1tfcHJvcF07XG4gIH07XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgcHJvcCwgZGVzYyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gcGF0Y2hPblByb3BlcnRpZXMob2JqOiBhbnksIHByb3BlcnRpZXM6IHN0cmluZ1tdKSB7XG4gIHZhciBvblByb3BlcnRpZXMgPSBbXTtcbiAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICBpZiAocHJvcC5zdWJzdHIoMCwgMikgPT0gJ29uJykge1xuICAgICAgb25Qcm9wZXJ0aWVzLnB1c2gocHJvcCk7XG4gICAgfVxuICB9XG4gIGZvcih2YXIgaiA9IDA7IGogPCBvblByb3BlcnRpZXMubGVuZ3RoOyBqKyspIHtcbiAgICBwYXRjaFByb3BlcnR5KG9iaiwgb25Qcm9wZXJ0aWVzW2pdKTtcbiAgfVxuICBpZiAocHJvcGVydGllcykge1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwYXRjaFByb3BlcnR5KG9iaiwgJ29uJyArIHByb3BlcnRpZXNbaV0pO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgRVZFTlRfVEFTS1MgPSB6b25lU3ltYm9sKCdldmVudFRhc2tzJyk7XG5jb25zdCBBRERfRVZFTlRfTElTVEVORVIgPSAnYWRkRXZlbnRMaXN0ZW5lcic7XG5jb25zdCBSRU1PVkVfRVZFTlRfTElTVEVORVIgPSAncmVtb3ZlRXZlbnRMaXN0ZW5lcic7XG5jb25zdCBTWU1CT0xfQUREX0VWRU5UX0xJU1RFTkVSID0gem9uZVN5bWJvbChBRERfRVZFTlRfTElTVEVORVIpO1xuY29uc3QgU1lNQk9MX1JFTU9WRV9FVkVOVF9MSVNURU5FUiA9IHpvbmVTeW1ib2woUkVNT1ZFX0VWRU5UX0xJU1RFTkVSKTtcblxuaW50ZXJmYWNlIExpc3RlbmVyVGFza01ldGEgZXh0ZW5kcyBUYXNrRGF0YSB7XG4gIHVzZUNhcHR1cmluZzogYm9vbGVhbixcbiAgZXZlbnROYW1lOiBzdHJpbmcsXG4gIGhhbmRsZXI6IGFueSxcbiAgdGFyZ2V0OiBhbnksXG4gIG5hbWU6IGFueVxufVxuXG5mdW5jdGlvbiBmaW5kRXhpc3RpbmdSZWdpc3RlcmVkVGFzayh0YXJnZXQ6IGFueSwgaGFuZGxlcjogYW55LCBuYW1lOiBzdHJpbmcsIGNhcHR1cmU6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmU6IGJvb2xlYW4pOiBUYXNrIHtcbiAgdmFyIGV2ZW50VGFza3M6IFRhc2tbXSA9IHRhcmdldFtFVkVOVF9UQVNLU107XG4gIGlmIChldmVudFRhc2tzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudFRhc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZXZlbnRUYXNrID0gZXZlbnRUYXNrc1tpXTtcbiAgICAgIHZhciBkYXRhID0gPExpc3RlbmVyVGFza01ldGE+ZXZlbnRUYXNrLmRhdGE7XG4gICAgICBpZiAoZGF0YS5oYW5kbGVyID09PSBoYW5kbGVyXG4gICAgICAgICAgJiYgZGF0YS51c2VDYXB0dXJpbmcgPT09IGNhcHR1cmVcbiAgICAgICAgICAmJiBkYXRhLmV2ZW50TmFtZSA9PT0gbmFtZSlcbiAgICAgIHtcbiAgICAgICAgaWYgKHJlbW92ZSkge1xuICAgICAgICAgIGV2ZW50VGFza3Muc3BsaWNlKGksIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudFRhc2s7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbmZ1bmN0aW9uIGF0dGFjaFJlZ2lzdGVyZWRFdmVudCh0YXJnZXQ6IGFueSwgZXZlbnRUYXNrOiBUYXNrKTogdm9pZCB7XG4gIHZhciBldmVudFRhc2tzOiBUYXNrW10gPSB0YXJnZXRbRVZFTlRfVEFTS1NdO1xuICBpZiAoIWV2ZW50VGFza3MpIHtcbiAgICBldmVudFRhc2tzID0gdGFyZ2V0W0VWRU5UX1RBU0tTXSA9IFtdO1xuICB9XG4gIGV2ZW50VGFza3MucHVzaChldmVudFRhc2spO1xufVxuXG5mdW5jdGlvbiBzY2hlZHVsZUV2ZW50TGlzdGVuZXIoZXZlbnRUYXNrOiBUYXNrKTogYW55IHtcbiAgdmFyIG1ldGEgPSA8TGlzdGVuZXJUYXNrTWV0YT5ldmVudFRhc2suZGF0YTtcbiAgYXR0YWNoUmVnaXN0ZXJlZEV2ZW50KG1ldGEudGFyZ2V0LCBldmVudFRhc2spO1xuICByZXR1cm4gbWV0YS50YXJnZXRbU1lNQk9MX0FERF9FVkVOVF9MSVNURU5FUl0obWV0YS5ldmVudE5hbWUsIGV2ZW50VGFzay5pbnZva2UsXG4gICAgICBtZXRhLnVzZUNhcHR1cmluZyk7XG59XG5cbmZ1bmN0aW9uIGNhbmNlbEV2ZW50TGlzdGVuZXIoZXZlbnRUYXNrOiBUYXNrKTogdm9pZCB7XG4gIHZhciBtZXRhID0gPExpc3RlbmVyVGFza01ldGE+ZXZlbnRUYXNrLmRhdGE7XG4gIGZpbmRFeGlzdGluZ1JlZ2lzdGVyZWRUYXNrKG1ldGEudGFyZ2V0LCBldmVudFRhc2suaW52b2tlLCBtZXRhLmV2ZW50TmFtZSxcbiAgICAgIG1ldGEudXNlQ2FwdHVyaW5nLCB0cnVlKTtcbiAgbWV0YS50YXJnZXRbU1lNQk9MX1JFTU9WRV9FVkVOVF9MSVNURU5FUl0obWV0YS5ldmVudE5hbWUsIGV2ZW50VGFzay5pbnZva2UsXG4gICAgICBtZXRhLnVzZUNhcHR1cmluZyk7XG59XG5cbmZ1bmN0aW9uIHpvbmVBd2FyZUFkZEV2ZW50TGlzdGVuZXIoc2VsZjogYW55LCBhcmdzOiBhbnlbXSkge1xuICB2YXIgZXZlbnROYW1lOiBzdHJpbmcgPSBhcmdzWzBdO1xuICB2YXIgaGFuZGxlcjogRXZlbnRMaXN0ZW5lck9yRXZlbnRMaXN0ZW5lck9iamVjdCA9IGFyZ3NbMV07XG4gIHZhciB1c2VDYXB0dXJpbmc6IGJvb2xlYW4gPSBhcmdzWzJdIHx8IGZhbHNlO1xuICAvLyAtIEluc2lkZSBhIFdlYiBXb3JrZXIsIGB0aGlzYCBpcyB1bmRlZmluZWQsIHRoZSBjb250ZXh0IGlzIGBnbG9iYWxgXG4gIC8vIC0gV2hlbiBgYWRkRXZlbnRMaXN0ZW5lcmAgaXMgY2FsbGVkIG9uIHRoZSBnbG9iYWwgY29udGV4dCBpbiBzdHJpY3QgbW9kZSwgYHRoaXNgIGlzIHVuZGVmaW5lZFxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvem9uZS5qcy9pc3N1ZXMvMTkwXG4gIHZhciB0YXJnZXQgPSBzZWxmIHx8IF9nbG9iYWw7XG4gIHZhciBkZWxlZ2F0ZTogRXZlbnRMaXN0ZW5lciA9IG51bGw7XG4gIGlmICh0eXBlb2YgaGFuZGxlciA9PSAnZnVuY3Rpb24nKSB7XG4gICAgZGVsZWdhdGUgPSA8RXZlbnRMaXN0ZW5lcj5oYW5kbGVyO1xuICB9IGVsc2UgaWYgKGhhbmRsZXIgJiYgKDxFdmVudExpc3RlbmVyT2JqZWN0PmhhbmRsZXIpLmhhbmRsZUV2ZW50KSB7XG4gICAgZGVsZWdhdGUgPSAoZXZlbnQpID0+ICg8RXZlbnRMaXN0ZW5lck9iamVjdD5oYW5kbGVyKS5oYW5kbGVFdmVudChldmVudCk7XG4gIH1cbiAgLy8gSWdub3JlIHNwZWNpYWwgbGlzdGVuZXJzIG9mIElFMTEgJiBFZGdlIGRldiB0b29scywgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL3pvbmUuanMvaXNzdWVzLzE1MFxuICBpZiAoIWRlbGVnYXRlIHx8IGhhbmRsZXIgJiYgaGFuZGxlci50b1N0cmluZygpID09PSBcIltvYmplY3QgRnVuY3Rpb25XcmFwcGVyXVwiKSB7XG4gICAgcmV0dXJuIHRhcmdldFtTWU1CT0xfQUREX0VWRU5UX0xJU1RFTkVSXShldmVudE5hbWUsIGhhbmRsZXIsIHVzZUNhcHR1cmluZyk7XG4gIH1cbiAgdmFyIGV2ZW50VGFzazogVGFza1xuICAgICAgPSBmaW5kRXhpc3RpbmdSZWdpc3RlcmVkVGFzayh0YXJnZXQsIGhhbmRsZXIsIGV2ZW50TmFtZSwgdXNlQ2FwdHVyaW5nLCBmYWxzZSk7XG4gIGlmIChldmVudFRhc2spIHtcbiAgICAvLyB3ZSBhbHJlYWR5IHJlZ2lzdGVyZWQsIHNvIHRoaXMgd2lsbCBoYXZlIG5vb3AuXG4gICAgcmV0dXJuIHRhcmdldFtTWU1CT0xfQUREX0VWRU5UX0xJU1RFTkVSXShldmVudE5hbWUsIGV2ZW50VGFzay5pbnZva2UsIHVzZUNhcHR1cmluZyk7XG4gIH1cbiAgdmFyIHpvbmU6IFpvbmUgPSBab25lLmN1cnJlbnQ7XG4gIHZhciBzb3VyY2UgPSB0YXJnZXQuY29uc3RydWN0b3JbJ25hbWUnXSArICcuYWRkRXZlbnRMaXN0ZW5lcjonICsgZXZlbnROYW1lO1xuICB2YXIgZGF0YTogTGlzdGVuZXJUYXNrTWV0YSA9IHtcbiAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICBldmVudE5hbWU6IGV2ZW50TmFtZSxcbiAgICBuYW1lOiBldmVudE5hbWUsXG4gICAgdXNlQ2FwdHVyaW5nOiB1c2VDYXB0dXJpbmcsXG4gICAgaGFuZGxlcjogaGFuZGxlclxuICB9O1xuICB6b25lLnNjaGVkdWxlRXZlbnRUYXNrKHNvdXJjZSwgZGVsZWdhdGUsIGRhdGEsIHNjaGVkdWxlRXZlbnRMaXN0ZW5lciwgY2FuY2VsRXZlbnRMaXN0ZW5lcik7XG59XG5cbmZ1bmN0aW9uIHpvbmVBd2FyZVJlbW92ZUV2ZW50TGlzdGVuZXIoc2VsZjogYW55LCBhcmdzOiBhbnlbXSkge1xuICB2YXIgZXZlbnROYW1lOiBzdHJpbmcgPSBhcmdzWzBdO1xuICB2YXIgaGFuZGxlcjogRXZlbnRMaXN0ZW5lck9yRXZlbnRMaXN0ZW5lck9iamVjdCA9IGFyZ3NbMV07XG4gIHZhciB1c2VDYXB0dXJpbmc6IGJvb2xlYW4gPSBhcmdzWzJdIHx8IGZhbHNlO1xuICAvLyAtIEluc2lkZSBhIFdlYiBXb3JrZXIsIGB0aGlzYCBpcyB1bmRlZmluZWQsIHRoZSBjb250ZXh0IGlzIGBnbG9iYWxgXG4gIC8vIC0gV2hlbiBgYWRkRXZlbnRMaXN0ZW5lcmAgaXMgY2FsbGVkIG9uIHRoZSBnbG9iYWwgY29udGV4dCBpbiBzdHJpY3QgbW9kZSwgYHRoaXNgIGlzIHVuZGVmaW5lZFxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvem9uZS5qcy9pc3N1ZXMvMTkwXG4gIHZhciB0YXJnZXQgPSBzZWxmIHx8IF9nbG9iYWw7XG4gIHZhciBldmVudFRhc2sgPSBmaW5kRXhpc3RpbmdSZWdpc3RlcmVkVGFzayh0YXJnZXQsIGhhbmRsZXIsIGV2ZW50TmFtZSwgdXNlQ2FwdHVyaW5nLCB0cnVlKTtcbiAgaWYgKGV2ZW50VGFzaykge1xuICAgIGV2ZW50VGFzay56b25lLmNhbmNlbFRhc2soZXZlbnRUYXNrKTtcbiAgfSBlbHNlIHtcbiAgICB0YXJnZXRbU1lNQk9MX1JFTU9WRV9FVkVOVF9MSVNURU5FUl0oZXZlbnROYW1lLCBoYW5kbGVyLCB1c2VDYXB0dXJpbmcpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXRjaEV2ZW50VGFyZ2V0TWV0aG9kcyhvYmo6IGFueSk6IGJvb2xlYW4ge1xuICBpZiAob2JqICYmIG9iai5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgcGF0Y2hNZXRob2Qob2JqLCBBRERfRVZFTlRfTElTVEVORVIsICgpID0+IHpvbmVBd2FyZUFkZEV2ZW50TGlzdGVuZXIpO1xuICAgIHBhdGNoTWV0aG9kKG9iaiwgUkVNT1ZFX0VWRU5UX0xJU1RFTkVSLCAoKSA9PiB6b25lQXdhcmVSZW1vdmVFdmVudExpc3RlbmVyKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5cbnZhciBvcmlnaW5hbEluc3RhbmNlS2V5ID0gem9uZVN5bWJvbCgnb3JpZ2luYWxJbnN0YW5jZScpO1xuXG4vLyB3cmFwIHNvbWUgbmF0aXZlIEFQSSBvbiBgd2luZG93YFxuZXhwb3J0IGZ1bmN0aW9uIHBhdGNoQ2xhc3MoY2xhc3NOYW1lKSB7XG4gIHZhciBPcmlnaW5hbENsYXNzID0gX2dsb2JhbFtjbGFzc05hbWVdO1xuICBpZiAoIU9yaWdpbmFsQ2xhc3MpIHJldHVybjtcblxuICBfZ2xvYmFsW2NsYXNzTmFtZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGEgPSBiaW5kQXJndW1lbnRzKDxhbnk+YXJndW1lbnRzLCBjbGFzc05hbWUpO1xuICAgIHN3aXRjaCAoYS5sZW5ndGgpIHtcbiAgICAgIGNhc2UgMDogdGhpc1tvcmlnaW5hbEluc3RhbmNlS2V5XSA9IG5ldyBPcmlnaW5hbENsYXNzKCk7IGJyZWFrO1xuICAgICAgY2FzZSAxOiB0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldID0gbmV3IE9yaWdpbmFsQ2xhc3MoYVswXSk7IGJyZWFrO1xuICAgICAgY2FzZSAyOiB0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldID0gbmV3IE9yaWdpbmFsQ2xhc3MoYVswXSwgYVsxXSk7IGJyZWFrO1xuICAgICAgY2FzZSAzOiB0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldID0gbmV3IE9yaWdpbmFsQ2xhc3MoYVswXSwgYVsxXSwgYVsyXSk7IGJyZWFrO1xuICAgICAgY2FzZSA0OiB0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldID0gbmV3IE9yaWdpbmFsQ2xhc3MoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7IGJyZWFrO1xuICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKCdBcmcgbGlzdCB0b28gbG9uZy4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGluc3RhbmNlID0gbmV3IE9yaWdpbmFsQ2xhc3MoZnVuY3Rpb24gKCkge30pO1xuXG4gIHZhciBwcm9wO1xuICBmb3IgKHByb3AgaW4gaW5zdGFuY2UpIHtcbiAgICAoZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2VbcHJvcF0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgX2dsb2JhbFtjbGFzc05hbWVdLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1tvcmlnaW5hbEluc3RhbmNlS2V5XVtwcm9wXS5hcHBseSh0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KF9nbG9iYWxbY2xhc3NOYW1lXS5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICB0aGlzW29yaWdpbmFsSW5zdGFuY2VLZXldW3Byb3BdID0gWm9uZS5jdXJyZW50LndyYXAoZm4sIGNsYXNzTmFtZSArICcuJyArIHByb3ApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpc1tvcmlnaW5hbEluc3RhbmNlS2V5XVtwcm9wXSA9IGZuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpc1tvcmlnaW5hbEluc3RhbmNlS2V5XVtwcm9wXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0ocHJvcCkpO1xuICB9XG5cbiAgZm9yIChwcm9wIGluIE9yaWdpbmFsQ2xhc3MpIHtcbiAgICBpZiAocHJvcCAhPT0gJ3Byb3RvdHlwZScgJiYgT3JpZ2luYWxDbGFzcy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgX2dsb2JhbFtjbGFzc05hbWVdW3Byb3BdID0gT3JpZ2luYWxDbGFzc1twcm9wXTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOYW1lZEZuKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICBkZWxlZ2F0ZTogKHNlbGY6IGFueSwgYXJnczogYW55W10pID0+IGFueSk6IEZ1bmN0aW9uXG57XG4gIHRyeSB7XG4gICAgcmV0dXJuIChGdW5jdGlvbihcbiAgICAgICAgJ2YnLFxuICAgICAgICBgcmV0dXJuIGZ1bmN0aW9uICR7bmFtZX0oKXtyZXR1cm4gZih0aGlzLCBhcmd1bWVudHMpfWApXG4gICAgKShkZWxlZ2F0ZSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBpZiB3ZSBmYWlsLCB3ZSBtdXN0IGJlIENTUCwganVzdCByZXR1cm4gZGVsZWdhdGUuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGRlbGVnYXRlKHRoaXMsIDxhbnk+YXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXRjaE1ldGhvZCh0YXJnZXQ6IGFueSwgbmFtZTogc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoRm46IChkZWxlZ2F0ZTogRnVuY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGVnYXRlTmFtZTogc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzdHJpbmcpID0+IChzZWxmOiBhbnksIGFyZ3M6IGFueVtdKSA9PiBhbnkpOiBGdW5jdGlvblxue1xuICB2YXIgcHJvdG8gPSB0YXJnZXQ7XG4gIHdoaWxlIChwcm90byAmJiAhcHJvdG8uaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwcm90byk7XG4gIH1cbiAgaWYgKCFwcm90byAmJiB0YXJnZXRbbmFtZV0pIHtcbiAgICAvLyBzb21laG93IHdlIGRpZCBub3QgZmluZCBpdCwgYnV0IHdlIGNhbiBzZWUgaXQuIFRoaXMgaGFwcGVucyBvbiBJRSBmb3IgV2luZG93IHByb3BlcnRpZXMuXG4gICAgcHJvdG8gPSB0YXJnZXQ7XG4gIH1cbiAgdmFyIGRlbGVnYXRlTmFtZSA9IHpvbmVTeW1ib2wobmFtZSk7XG4gIHZhciBkZWxlZ2F0ZTogRnVuY3Rpb247XG4gIGlmIChwcm90byAmJiAhIChkZWxlZ2F0ZSA9IHByb3RvW2RlbGVnYXRlTmFtZV0pKSB7XG4gICAgZGVsZWdhdGUgPSBwcm90b1tkZWxlZ2F0ZU5hbWVdID0gcHJvdG9bbmFtZV07XG4gICAgcHJvdG9bbmFtZV0gPSBjcmVhdGVOYW1lZEZuKG5hbWUsIHBhdGNoRm4oZGVsZWdhdGUsIGRlbGVnYXRlTmFtZSwgbmFtZSkpO1xuICB9XG4gIHJldHVybiBkZWxlZ2F0ZTtcbn1cblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
