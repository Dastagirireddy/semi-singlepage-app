System.register(['angular2/src/facade/lang', 'angular2/src/facade/collection', './template_ast', './source_module', 'angular2/src/core/linker/view', 'angular2/src/core/linker/view_type', 'angular2/src/core/linker/element', 'angular2/src/core/metadata/view', './util', 'angular2/src/core/di', './proto_view_compiler'], function(exports_1, context_1) {
    "use strict";
    var __moduleName = context_1 && context_1.id;
    var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    };
    var __metadata = (this && this.__metadata) || function (k, v) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
    };
    var lang_1, collection_1, template_ast_1, source_module_1, view_1, view_type_1, element_1, view_2, util_1, di_1, proto_view_compiler_1;
    var VIEW_JIT_IMPORTS, ViewCompiler, CodeGenViewFactory, RuntimeViewFactory, ParentElement, ViewBuilderVisitor;
    function codeGenEventHandler(view, boundElementIndex, eventName) {
        return util_1.codeGenValueFn(['event'], view.expression + ".triggerEventHandlers(" + util_1.escapeValue(eventName) + ", event, " + boundElementIndex + ")");
    }
    function codeGenViewFactoryName(component, embeddedTemplateIndex) {
        return "viewFactory_" + component.type.name + embeddedTemplateIndex;
    }
    function codeGenViewEncapsulation(value) {
        if (lang_1.IS_DART) {
            return "" + proto_view_compiler_1.METADATA_MODULE_REF + value;
        }
        else {
            return "" + value;
        }
    }
    return {
        setters:[
            function (lang_1_1) {
                lang_1 = lang_1_1;
            },
            function (collection_1_1) {
                collection_1 = collection_1_1;
            },
            function (template_ast_1_1) {
                template_ast_1 = template_ast_1_1;
            },
            function (source_module_1_1) {
                source_module_1 = source_module_1_1;
            },
            function (view_1_1) {
                view_1 = view_1_1;
            },
            function (view_type_1_1) {
                view_type_1 = view_type_1_1;
            },
            function (element_1_1) {
                element_1 = element_1_1;
            },
            function (view_2_1) {
                view_2 = view_2_1;
            },
            function (util_1_1) {
                util_1 = util_1_1;
            },
            function (di_1_1) {
                di_1 = di_1_1;
            },
            function (proto_view_compiler_1_1) {
                proto_view_compiler_1 = proto_view_compiler_1_1;
            }],
        execute: function() {
            exports_1("VIEW_JIT_IMPORTS", VIEW_JIT_IMPORTS = lang_1.CONST_EXPR({
                'AppView': view_1.AppView,
                'AppElement': element_1.AppElement,
                'flattenNestedViewRenderNodes': view_1.flattenNestedViewRenderNodes,
                'checkSlotCount': view_1.checkSlotCount
            }));
            ViewCompiler = (function () {
                function ViewCompiler() {
                }
                ViewCompiler.prototype.compileComponentRuntime = function (component, template, styles, protoViews, changeDetectorFactories, componentViewFactory) {
                    var viewFactory = new RuntimeViewFactory(component, styles, protoViews, changeDetectorFactories, componentViewFactory);
                    return viewFactory.createViewFactory(template, 0, []);
                };
                ViewCompiler.prototype.compileComponentCodeGen = function (component, template, styles, protoViews, changeDetectorFactoryExpressions, componentViewFactory) {
                    var viewFactory = new CodeGenViewFactory(component, styles, protoViews, changeDetectorFactoryExpressions, componentViewFactory);
                    var targetStatements = [];
                    var viewFactoryExpression = viewFactory.createViewFactory(template, 0, targetStatements);
                    return new source_module_1.SourceExpression(targetStatements.map(function (stmt) { return stmt.statement; }), viewFactoryExpression.expression);
                };
                ViewCompiler = __decorate([
                    di_1.Injectable(), 
                    __metadata('design:paramtypes', [])
                ], ViewCompiler);
                return ViewCompiler;
            }());
            exports_1("ViewCompiler", ViewCompiler);
            CodeGenViewFactory = (function () {
                function CodeGenViewFactory(component, styles, protoViews, changeDetectorExpressions, componentViewFactory) {
                    this.component = component;
                    this.styles = styles;
                    this.protoViews = protoViews;
                    this.changeDetectorExpressions = changeDetectorExpressions;
                    this.componentViewFactory = componentViewFactory;
                    this._nextVarId = 0;
                }
                CodeGenViewFactory.prototype._nextVar = function (prefix) {
                    return "" + prefix + this._nextVarId++ + "_" + this.component.type.name;
                };
                CodeGenViewFactory.prototype._nextRenderVar = function () { return this._nextVar('render'); };
                CodeGenViewFactory.prototype._nextAppVar = function () { return this._nextVar('app'); };
                CodeGenViewFactory.prototype._nextDisposableVar = function () {
                    return "disposable" + this._nextVarId++ + "_" + this.component.type.name;
                };
                CodeGenViewFactory.prototype.createText = function (renderer, parent, text, targetStatements) {
                    var varName = this._nextRenderVar();
                    var statement = "var " + varName + " = " + renderer.expression + ".createText(" + (lang_1.isPresent(parent) ? parent.expression : null) + ", " + util_1.escapeSingleQuoteString(text) + ");";
                    targetStatements.push(new util_1.Statement(statement));
                    return new util_1.Expression(varName);
                };
                CodeGenViewFactory.prototype.createElement = function (renderer, parentRenderNode, name, rootSelector, targetStatements) {
                    var varName = this._nextRenderVar();
                    var valueExpr;
                    if (lang_1.isPresent(rootSelector)) {
                        valueExpr = rootSelector.expression + " == null ?\n        " + renderer.expression + ".createElement(" + (lang_1.isPresent(parentRenderNode) ? parentRenderNode.expression : null) + ", " + util_1.escapeSingleQuoteString(name) + ") :\n        " + renderer.expression + ".selectRootElement(" + rootSelector.expression + ");";
                    }
                    else {
                        valueExpr =
                            renderer.expression + ".createElement(" + (lang_1.isPresent(parentRenderNode) ? parentRenderNode.expression : null) + ", " + util_1.escapeSingleQuoteString(name) + ")";
                    }
                    var statement = "var " + varName + " = " + valueExpr + ";";
                    targetStatements.push(new util_1.Statement(statement));
                    return new util_1.Expression(varName);
                };
                CodeGenViewFactory.prototype.createTemplateAnchor = function (renderer, parentRenderNode, targetStatements) {
                    var varName = this._nextRenderVar();
                    var valueExpr = renderer.expression + ".createTemplateAnchor(" + (lang_1.isPresent(parentRenderNode) ? parentRenderNode.expression : null) + ");";
                    targetStatements.push(new util_1.Statement("var " + varName + " = " + valueExpr));
                    return new util_1.Expression(varName);
                };
                CodeGenViewFactory.prototype.createGlobalEventListener = function (renderer, appView, boundElementIndex, eventAst, targetStatements) {
                    var disposableVar = this._nextDisposableVar();
                    var eventHandlerExpr = codeGenEventHandler(appView, boundElementIndex, eventAst.fullName);
                    targetStatements.push(new util_1.Statement("var " + disposableVar + " = " + renderer.expression + ".listenGlobal(" + util_1.escapeValue(eventAst.target) + ", " + util_1.escapeValue(eventAst.name) + ", " + eventHandlerExpr + ");"));
                    return new util_1.Expression(disposableVar);
                };
                CodeGenViewFactory.prototype.createElementEventListener = function (renderer, appView, boundElementIndex, renderNode, eventAst, targetStatements) {
                    var disposableVar = this._nextDisposableVar();
                    var eventHandlerExpr = codeGenEventHandler(appView, boundElementIndex, eventAst.fullName);
                    targetStatements.push(new util_1.Statement("var " + disposableVar + " = " + renderer.expression + ".listen(" + renderNode.expression + ", " + util_1.escapeValue(eventAst.name) + ", " + eventHandlerExpr + ");"));
                    return new util_1.Expression(disposableVar);
                };
                CodeGenViewFactory.prototype.setElementAttribute = function (renderer, renderNode, attrName, attrValue, targetStatements) {
                    targetStatements.push(new util_1.Statement(renderer.expression + ".setElementAttribute(" + renderNode.expression + ", " + util_1.escapeSingleQuoteString(attrName) + ", " + util_1.escapeSingleQuoteString(attrValue) + ");"));
                };
                CodeGenViewFactory.prototype.createAppElement = function (appProtoEl, appView, renderNode, parentAppEl, embeddedViewFactory, targetStatements) {
                    var appVar = this._nextAppVar();
                    var varValue = "new " + proto_view_compiler_1.APP_EL_MODULE_REF + "AppElement(" + appProtoEl.expression + ", " + appView.expression + ",\n      " + (lang_1.isPresent(parentAppEl) ? parentAppEl.expression : null) + ", " + renderNode.expression + ", " + (lang_1.isPresent(embeddedViewFactory) ? embeddedViewFactory.expression : null) + ")";
                    targetStatements.push(new util_1.Statement("var " + appVar + " = " + varValue + ";"));
                    return new util_1.Expression(appVar);
                };
                CodeGenViewFactory.prototype.createAndSetComponentView = function (renderer, viewManager, view, appEl, component, contentNodesByNgContentIndex, targetStatements) {
                    var codeGenContentNodes;
                    if (this.component.type.isHost) {
                        codeGenContentNodes = view.expression + ".projectableNodes";
                    }
                    else {
                        codeGenContentNodes =
                            "[" + contentNodesByNgContentIndex.map(function (nodes) { return util_1.codeGenFlatArray(nodes); }).join(',') + "]";
                    }
                    targetStatements.push(new util_1.Statement(this.componentViewFactory(component) + "(" + renderer.expression + ", " + viewManager.expression + ", " + appEl.expression + ", " + codeGenContentNodes + ", null, null, null);"));
                };
                CodeGenViewFactory.prototype.getProjectedNodes = function (projectableNodes, ngContentIndex) {
                    return new util_1.Expression(projectableNodes.expression + "[" + ngContentIndex + "]", true);
                };
                CodeGenViewFactory.prototype.appendProjectedNodes = function (renderer, parent, nodes, targetStatements) {
                    targetStatements.push(new util_1.Statement(renderer.expression + ".projectNodes(" + parent.expression + ", " + proto_view_compiler_1.APP_VIEW_MODULE_REF + "flattenNestedViewRenderNodes(" + nodes.expression + "));"));
                };
                CodeGenViewFactory.prototype.createViewFactory = function (asts, embeddedTemplateIndex, targetStatements) {
                    var compileProtoView = this.protoViews[embeddedTemplateIndex];
                    var isHostView = this.component.type.isHost;
                    var isComponentView = embeddedTemplateIndex === 0 && !isHostView;
                    var visitor = new ViewBuilderVisitor(new util_1.Expression('renderer'), new util_1.Expression('viewManager'), new util_1.Expression('projectableNodes'), isHostView ? new util_1.Expression('rootSelector') : null, new util_1.Expression('view'), compileProtoView, targetStatements, this);
                    template_ast_1.templateVisitAll(visitor, asts, new ParentElement(isComponentView ? new util_1.Expression('parentRenderNode') : null, null, null));
                    var appProtoView = compileProtoView.protoView.expression;
                    var viewFactoryName = codeGenViewFactoryName(this.component, embeddedTemplateIndex);
                    var changeDetectorFactory = this.changeDetectorExpressions.expressions[embeddedTemplateIndex];
                    var factoryArgs = [
                        'parentRenderer',
                        'viewManager',
                        'containerEl',
                        'projectableNodes',
                        'rootSelector',
                        'dynamicallyCreatedProviders',
                        'rootInjector'
                    ];
                    var initRendererStmts = [];
                    var rendererExpr = "parentRenderer";
                    if (embeddedTemplateIndex === 0) {
                        var renderCompTypeVar = this._nextVar('renderType');
                        targetStatements.push(new util_1.Statement("var " + renderCompTypeVar + " = null;"));
                        var stylesVar = this._nextVar('styles');
                        targetStatements.push(new util_1.Statement(util_1.CONST_VAR + " " + stylesVar + " = " + this.styles.expression + ";"));
                        var encapsulation = this.component.template.encapsulation;
                        initRendererStmts.push("if (" + renderCompTypeVar + " == null) {\n        " + renderCompTypeVar + " = viewManager.createRenderComponentType(" + codeGenViewEncapsulation(encapsulation) + ", " + stylesVar + ");\n      }");
                        rendererExpr = "parentRenderer.renderComponent(" + renderCompTypeVar + ")";
                    }
                    var statement = "\n" + util_1.codeGenFnHeader(factoryArgs, viewFactoryName) + "{\n  " + initRendererStmts.join('\n') + "\n  var renderer = " + rendererExpr + ";\n  var view = new " + proto_view_compiler_1.APP_VIEW_MODULE_REF + "AppView(\n    " + appProtoView + ", renderer, viewManager,\n    projectableNodes,\n    containerEl,\n    dynamicallyCreatedProviders, rootInjector,\n    " + changeDetectorFactory + "()\n  );\n  " + proto_view_compiler_1.APP_VIEW_MODULE_REF + "checkSlotCount(" + util_1.escapeValue(this.component.type.name) + ", " + this.component.template.ngContentSelectors.length + ", projectableNodes);\n  " + (isComponentView ? 'var parentRenderNode = renderer.createViewRoot(view.containerAppElement.nativeElement);' : '') + "\n  " + visitor.renderStmts.map(function (stmt) { return stmt.statement; }).join('\n') + "\n  " + visitor.appStmts.map(function (stmt) { return stmt.statement; }).join('\n') + "\n\n  view.init(" + util_1.codeGenFlatArray(visitor.rootNodesOrAppElements) + ", " + util_1.codeGenArray(visitor.renderNodes) + ", " + util_1.codeGenArray(visitor.appDisposables) + ",\n            " + util_1.codeGenArray(visitor.appElements) + ");\n  return view;\n}";
                    targetStatements.push(new util_1.Statement(statement));
                    return new util_1.Expression(viewFactoryName);
                };
                return CodeGenViewFactory;
            }());
            RuntimeViewFactory = (function () {
                function RuntimeViewFactory(component, styles, protoViews, changeDetectorFactories, componentViewFactory) {
                    this.component = component;
                    this.styles = styles;
                    this.protoViews = protoViews;
                    this.changeDetectorFactories = changeDetectorFactories;
                    this.componentViewFactory = componentViewFactory;
                }
                RuntimeViewFactory.prototype.createText = function (renderer, parent, text, targetStatements) {
                    return renderer.createText(parent, text);
                };
                RuntimeViewFactory.prototype.createElement = function (renderer, parent, name, rootSelector, targetStatements) {
                    var el;
                    if (lang_1.isPresent(rootSelector)) {
                        el = renderer.selectRootElement(rootSelector);
                    }
                    else {
                        el = renderer.createElement(parent, name);
                    }
                    return el;
                };
                RuntimeViewFactory.prototype.createTemplateAnchor = function (renderer, parent, targetStatements) {
                    return renderer.createTemplateAnchor(parent);
                };
                RuntimeViewFactory.prototype.createGlobalEventListener = function (renderer, appView, boundElementIndex, eventAst, targetStatements) {
                    return renderer.listenGlobal(eventAst.target, eventAst.name, function (event) { return appView.triggerEventHandlers(eventAst.fullName, event, boundElementIndex); });
                };
                RuntimeViewFactory.prototype.createElementEventListener = function (renderer, appView, boundElementIndex, renderNode, eventAst, targetStatements) {
                    return renderer.listen(renderNode, eventAst.name, function (event) { return appView.triggerEventHandlers(eventAst.fullName, event, boundElementIndex); });
                };
                RuntimeViewFactory.prototype.setElementAttribute = function (renderer, renderNode, attrName, attrValue, targetStatements) {
                    renderer.setElementAttribute(renderNode, attrName, attrValue);
                };
                RuntimeViewFactory.prototype.createAppElement = function (appProtoEl, appView, renderNode, parentAppEl, embeddedViewFactory, targetStatements) {
                    return new element_1.AppElement(appProtoEl, appView, parentAppEl, renderNode, embeddedViewFactory);
                };
                RuntimeViewFactory.prototype.createAndSetComponentView = function (renderer, viewManager, appView, appEl, component, contentNodesByNgContentIndex, targetStatements) {
                    var flattenedContentNodes;
                    if (this.component.type.isHost) {
                        flattenedContentNodes = appView.projectableNodes;
                    }
                    else {
                        flattenedContentNodes = collection_1.ListWrapper.createFixedSize(contentNodesByNgContentIndex.length);
                        for (var i = 0; i < contentNodesByNgContentIndex.length; i++) {
                            flattenedContentNodes[i] = util_1.flattenArray(contentNodesByNgContentIndex[i], []);
                        }
                    }
                    this.componentViewFactory(component)(renderer, viewManager, appEl, flattenedContentNodes);
                };
                RuntimeViewFactory.prototype.getProjectedNodes = function (projectableNodes, ngContentIndex) {
                    return projectableNodes[ngContentIndex];
                };
                RuntimeViewFactory.prototype.appendProjectedNodes = function (renderer, parent, nodes, targetStatements) {
                    renderer.projectNodes(parent, view_1.flattenNestedViewRenderNodes(nodes));
                };
                RuntimeViewFactory.prototype.createViewFactory = function (asts, embeddedTemplateIndex, targetStatements) {
                    var _this = this;
                    var compileProtoView = this.protoViews[embeddedTemplateIndex];
                    var isComponentView = compileProtoView.protoView.type === view_type_1.ViewType.COMPONENT;
                    var renderComponentType = null;
                    return function (parentRenderer, viewManager, containerEl, projectableNodes, rootSelector, dynamicallyCreatedProviders, rootInjector) {
                        if (rootSelector === void 0) { rootSelector = null; }
                        if (dynamicallyCreatedProviders === void 0) { dynamicallyCreatedProviders = null; }
                        if (rootInjector === void 0) { rootInjector = null; }
                        view_1.checkSlotCount(_this.component.type.name, _this.component.template.ngContentSelectors.length, projectableNodes);
                        var renderer;
                        if (embeddedTemplateIndex === 0) {
                            if (lang_1.isBlank(renderComponentType)) {
                                renderComponentType = viewManager.createRenderComponentType(_this.component.template.encapsulation, _this.styles);
                            }
                            renderer = parentRenderer.renderComponent(renderComponentType);
                        }
                        else {
                            renderer = parentRenderer;
                        }
                        var changeDetector = _this.changeDetectorFactories[embeddedTemplateIndex]();
                        var view = new view_1.AppView(compileProtoView.protoView, renderer, viewManager, projectableNodes, containerEl, dynamicallyCreatedProviders, rootInjector, changeDetector);
                        var visitor = new ViewBuilderVisitor(renderer, viewManager, projectableNodes, rootSelector, view, compileProtoView, [], _this);
                        var parentRenderNode = isComponentView ? renderer.createViewRoot(containerEl.nativeElement) : null;
                        template_ast_1.templateVisitAll(visitor, asts, new ParentElement(parentRenderNode, null, null));
                        view.init(util_1.flattenArray(visitor.rootNodesOrAppElements, []), visitor.renderNodes, visitor.appDisposables, visitor.appElements);
                        return view;
                    };
                };
                return RuntimeViewFactory;
            }());
            ParentElement = (function () {
                function ParentElement(renderNode, appEl, component) {
                    this.renderNode = renderNode;
                    this.appEl = appEl;
                    this.component = component;
                    if (lang_1.isPresent(component)) {
                        this.contentNodesByNgContentIndex =
                            collection_1.ListWrapper.createFixedSize(component.template.ngContentSelectors.length);
                        for (var i = 0; i < this.contentNodesByNgContentIndex.length; i++) {
                            this.contentNodesByNgContentIndex[i] = [];
                        }
                    }
                    else {
                        this.contentNodesByNgContentIndex = null;
                    }
                }
                ParentElement.prototype.addContentNode = function (ngContentIndex, nodeExpr) {
                    this.contentNodesByNgContentIndex[ngContentIndex].push(nodeExpr);
                };
                return ParentElement;
            }());
            ViewBuilderVisitor = (function () {
                function ViewBuilderVisitor(renderer, viewManager, projectableNodes, rootSelector, view, protoView, targetStatements, factory) {
                    this.renderer = renderer;
                    this.viewManager = viewManager;
                    this.projectableNodes = projectableNodes;
                    this.rootSelector = rootSelector;
                    this.view = view;
                    this.protoView = protoView;
                    this.targetStatements = targetStatements;
                    this.factory = factory;
                    this.renderStmts = [];
                    this.renderNodes = [];
                    this.appStmts = [];
                    this.appElements = [];
                    this.appDisposables = [];
                    this.rootNodesOrAppElements = [];
                    this.elementCount = 0;
                }
                ViewBuilderVisitor.prototype._addRenderNode = function (renderNode, appEl, ngContentIndex, parent) {
                    this.renderNodes.push(renderNode);
                    if (lang_1.isPresent(parent.component)) {
                        if (lang_1.isPresent(ngContentIndex)) {
                            parent.addContentNode(ngContentIndex, lang_1.isPresent(appEl) ? appEl : renderNode);
                        }
                    }
                    else if (lang_1.isBlank(parent.renderNode)) {
                        this.rootNodesOrAppElements.push(lang_1.isPresent(appEl) ? appEl : renderNode);
                    }
                };
                ViewBuilderVisitor.prototype._getParentRenderNode = function (ngContentIndex, parent) {
                    return lang_1.isPresent(parent.component) &&
                        parent.component.template.encapsulation !== view_2.ViewEncapsulation.Native ?
                        null :
                        parent.renderNode;
                };
                ViewBuilderVisitor.prototype.visitBoundText = function (ast, parent) {
                    return this._visitText('', ast.ngContentIndex, parent);
                };
                ViewBuilderVisitor.prototype.visitText = function (ast, parent) {
                    return this._visitText(ast.value, ast.ngContentIndex, parent);
                };
                ViewBuilderVisitor.prototype._visitText = function (value, ngContentIndex, parent) {
                    var renderNode = this.factory.createText(this.renderer, this._getParentRenderNode(ngContentIndex, parent), value, this.renderStmts);
                    this._addRenderNode(renderNode, null, ngContentIndex, parent);
                    return null;
                };
                ViewBuilderVisitor.prototype.visitNgContent = function (ast, parent) {
                    var nodesExpression = this.factory.getProjectedNodes(this.projectableNodes, ast.index);
                    if (lang_1.isPresent(parent.component)) {
                        if (lang_1.isPresent(ast.ngContentIndex)) {
                            parent.addContentNode(ast.ngContentIndex, nodesExpression);
                        }
                    }
                    else {
                        if (lang_1.isPresent(parent.renderNode)) {
                            this.factory.appendProjectedNodes(this.renderer, parent.renderNode, nodesExpression, this.renderStmts);
                        }
                        else {
                            this.rootNodesOrAppElements.push(nodesExpression);
                        }
                    }
                    return null;
                };
                ViewBuilderVisitor.prototype.visitElement = function (ast, parent) {
                    var _this = this;
                    var renderNode = this.factory.createElement(this.renderer, this._getParentRenderNode(ast.ngContentIndex, parent), ast.name, this.rootSelector, this.renderStmts);
                    var component = ast.getComponent();
                    var elementIndex = this.elementCount++;
                    var protoEl = this.protoView.protoElements[elementIndex];
                    protoEl.renderEvents.forEach(function (eventAst) {
                        var disposable;
                        if (lang_1.isPresent(eventAst.target)) {
                            disposable = _this.factory.createGlobalEventListener(_this.renderer, _this.view, protoEl.boundElementIndex, eventAst, _this.renderStmts);
                        }
                        else {
                            disposable = _this.factory.createElementEventListener(_this.renderer, _this.view, protoEl.boundElementIndex, renderNode, eventAst, _this.renderStmts);
                        }
                        _this.appDisposables.push(disposable);
                    });
                    for (var i = 0; i < protoEl.attrNameAndValues.length; i++) {
                        var attrName = protoEl.attrNameAndValues[i][0];
                        var attrValue = protoEl.attrNameAndValues[i][1];
                        this.factory.setElementAttribute(this.renderer, renderNode, attrName, attrValue, this.renderStmts);
                    }
                    var appEl = null;
                    if (lang_1.isPresent(protoEl.appProtoEl)) {
                        appEl = this.factory.createAppElement(protoEl.appProtoEl, this.view, renderNode, parent.appEl, null, this.appStmts);
                        this.appElements.push(appEl);
                    }
                    this._addRenderNode(renderNode, appEl, ast.ngContentIndex, parent);
                    var newParent = new ParentElement(renderNode, lang_1.isPresent(appEl) ? appEl : parent.appEl, component);
                    template_ast_1.templateVisitAll(this, ast.children, newParent);
                    if (lang_1.isPresent(appEl) && lang_1.isPresent(component)) {
                        this.factory.createAndSetComponentView(this.renderer, this.viewManager, this.view, appEl, component, newParent.contentNodesByNgContentIndex, this.appStmts);
                    }
                    return null;
                };
                ViewBuilderVisitor.prototype.visitEmbeddedTemplate = function (ast, parent) {
                    var renderNode = this.factory.createTemplateAnchor(this.renderer, this._getParentRenderNode(ast.ngContentIndex, parent), this.renderStmts);
                    var elementIndex = this.elementCount++;
                    var protoEl = this.protoView.protoElements[elementIndex];
                    var embeddedViewFactory = this.factory.createViewFactory(ast.children, protoEl.embeddedTemplateIndex, this.targetStatements);
                    var appEl = this.factory.createAppElement(protoEl.appProtoEl, this.view, renderNode, parent.appEl, embeddedViewFactory, this.appStmts);
                    this._addRenderNode(renderNode, appEl, ast.ngContentIndex, parent);
                    this.appElements.push(appEl);
                    return null;
                };
                ViewBuilderVisitor.prototype.visitVariable = function (ast, ctx) { return null; };
                ViewBuilderVisitor.prototype.visitAttr = function (ast, ctx) { return null; };
                ViewBuilderVisitor.prototype.visitDirective = function (ast, ctx) { return null; };
                ViewBuilderVisitor.prototype.visitEvent = function (ast, ctx) { return null; };
                ViewBuilderVisitor.prototype.visitDirectiveProperty = function (ast, context) { return null; };
                ViewBuilderVisitor.prototype.visitElementProperty = function (ast, context) { return null; };
                return ViewBuilderVisitor;
            }());
        }
    }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpYy9ub2RlX21vZHVsZXMvYW5ndWxhcjIvdHMvc3JjL2NvbXBpbGVyL3ZpZXdfY29tcGlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztRQStEYSxnQkFBZ0I7SUE0Z0I3Qiw2QkFBNkIsSUFBZ0IsRUFBRSxpQkFBeUIsRUFDM0MsU0FBaUI7UUFDNUMsTUFBTSxDQUFDLHFCQUFjLENBQ2pCLENBQUMsT0FBTyxDQUFDLEVBQ04sSUFBSSxDQUFDLFVBQVUsOEJBQXlCLGtCQUFXLENBQUMsU0FBUyxDQUFDLGlCQUFZLGlCQUFpQixNQUFHLENBQUMsQ0FBQztJQUN6RyxDQUFDO0lBRUQsZ0NBQWdDLFNBQW1DLEVBQ25DLHFCQUE2QjtRQUMzRCxNQUFNLENBQUMsaUJBQWUsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcscUJBQXVCLENBQUM7SUFDdEUsQ0FBQztJQUVELGtDQUFrQyxLQUF3QjtRQUN4RCxFQUFFLENBQUMsQ0FBQyxjQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ1osTUFBTSxDQUFDLEtBQUcseUNBQW1CLEdBQUcsS0FBTyxDQUFDO1FBQzFDLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNOLE1BQU0sQ0FBQyxLQUFHLEtBQU8sQ0FBQztRQUNwQixDQUFDO0lBQ0gsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQTloQlksOEJBQUEsZ0JBQWdCLEdBQUcsaUJBQVUsQ0FBQztnQkFDekMsU0FBUyxFQUFFLGNBQU87Z0JBQ2xCLFlBQVksRUFBRSxvQkFBVTtnQkFDeEIsOEJBQThCLEVBQUUsbUNBQTRCO2dCQUM1RCxnQkFBZ0IsRUFBRSxxQkFBYzthQUNqQyxDQUFDLENBQUEsQ0FBQztZQUlIO2dCQUNFO2dCQUFlLENBQUM7Z0JBRWhCLDhDQUF1QixHQUF2QixVQUF3QixTQUFtQyxFQUFFLFFBQXVCLEVBQzVELE1BQTZCLEVBQzdCLFVBQTZELEVBQzdELHVCQUFtQyxFQUNuQyxv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TSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQzFGLGlEQUFvQixHQUFwQixVQUFxQixHQUE0QixFQUFFLE9BQVksSUFBUyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDeEYseUJBQUM7WUFBRCxDQXZJQSxBQXVJQyxJQUFBIiwiZmlsZSI6InB1YmxpYy9ub2RlX21vZHVsZXMvYW5ndWxhcjIvdHMvc3JjL2NvbXBpbGVyL3ZpZXdfY29tcGlsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBpc1ByZXNlbnQsXG4gIGlzQmxhbmssXG4gIFR5cGUsXG4gIGlzU3RyaW5nLFxuICBTdHJpbmdXcmFwcGVyLFxuICBJU19EQVJULFxuICBDT05TVF9FWFBSXG59IGZyb20gJ2FuZ3VsYXIyL3NyYy9mYWNhZGUvbGFuZyc7XG5pbXBvcnQge1NldFdyYXBwZXIsIFN0cmluZ01hcFdyYXBwZXIsIExpc3RXcmFwcGVyfSBmcm9tICdhbmd1bGFyMi9zcmMvZmFjYWRlL2NvbGxlY3Rpb24nO1xuaW1wb3J0IHtcbiAgVGVtcGxhdGVBc3QsXG4gIFRlbXBsYXRlQXN0VmlzaXRvcixcbiAgTmdDb250ZW50QXN0LFxuICBFbWJlZGRlZFRlbXBsYXRlQXN0LFxuICBFbGVtZW50QXN0LFxuICBWYXJpYWJsZUFzdCxcbiAgQm91bmRFdmVudEFzdCxcbiAgQm91bmRFbGVtZW50UHJvcGVydHlBc3QsXG4gIEF0dHJBc3QsXG4gIEJvdW5kVGV4dEFzdCxcbiAgVGV4dEFzdCxcbiAgRGlyZWN0aXZlQXN0LFxuICBCb3VuZERpcmVjdGl2ZVByb3BlcnR5QXN0LFxuICB0ZW1wbGF0ZVZpc2l0QWxsXG59IGZyb20gJy4vdGVtcGxhdGVfYXN0JztcbmltcG9ydCB7Q29tcGlsZVR5cGVNZXRhZGF0YSwgQ29tcGlsZURpcmVjdGl2ZU1ldGFkYXRhfSBmcm9tICcuL2RpcmVjdGl2ZV9tZXRhZGF0YSc7XG5pbXBvcnQge1NvdXJjZUV4cHJlc3Npb25zLCBTb3VyY2VFeHByZXNzaW9uLCBtb2R1bGVSZWZ9IGZyb20gJy4vc291cmNlX21vZHVsZSc7XG5pbXBvcnQge1xuICBBcHBQcm90b1ZpZXcsXG4gIEFwcFZpZXcsXG4gIGZsYXR0ZW5OZXN0ZWRWaWV3UmVuZGVyTm9kZXMsXG4gIGNoZWNrU2xvdENvdW50XG59IGZyb20gJ2FuZ3VsYXIyL3NyYy9jb3JlL2xpbmtlci92aWV3JztcbmltcG9ydCB7Vmlld1R5cGV9IGZyb20gJ2FuZ3VsYXIyL3NyYy9jb3JlL2xpbmtlci92aWV3X3R5cGUnO1xuaW1wb3J0IHtBcHBWaWV3TWFuYWdlcl99IGZyb20gJ2FuZ3VsYXIyL3NyYy9jb3JlL2xpbmtlci92aWV3X21hbmFnZXInO1xuaW1wb3J0IHtBcHBQcm90b0VsZW1lbnQsIEFwcEVsZW1lbnR9IGZyb20gJ2FuZ3VsYXIyL3NyYy9jb3JlL2xpbmtlci9lbGVtZW50JztcbmltcG9ydCB7UmVuZGVyZXIsIFBhcmVudFJlbmRlcmVyfSBmcm9tICdhbmd1bGFyMi9zcmMvY29yZS9yZW5kZXIvYXBpJztcbmltcG9ydCB7Vmlld0VuY2Fwc3VsYXRpb259IGZyb20gJ2FuZ3VsYXIyL3NyYy9jb3JlL21ldGFkYXRhL3ZpZXcnO1xuaW1wb3J0IHtcbiAgZXNjYXBlU2luZ2xlUXVvdGVTdHJpbmcsXG4gIGNvZGVHZW5Db25zdENvbnN0cnVjdG9yQ2FsbCxcbiAgY29kZUdlblZhbHVlRm4sXG4gIGNvZGVHZW5GbkhlYWRlcixcbiAgTU9EVUxFX1NVRkZJWCxcbiAgU3RhdGVtZW50LFxuICBlc2NhcGVWYWx1ZSxcbiAgY29kZUdlbkFycmF5LFxuICBjb2RlR2VuRmxhdEFycmF5LFxuICBFeHByZXNzaW9uLFxuICBmbGF0dGVuQXJyYXksXG4gIENPTlNUX1ZBUlxufSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHtSZXNvbHZlZFByb3ZpZGVyLCBJbmplY3RhYmxlLCBJbmplY3Rvcn0gZnJvbSAnYW5ndWxhcjIvc3JjL2NvcmUvZGknO1xuXG5pbXBvcnQge1xuICBBUFBfVklFV19NT0RVTEVfUkVGLFxuICBBUFBfRUxfTU9EVUxFX1JFRixcbiAgTUVUQURBVEFfTU9EVUxFX1JFRixcbiAgQ29tcGlsZVByb3RvVmlldyxcbiAgQ29tcGlsZVByb3RvRWxlbWVudFxufSBmcm9tICcuL3Byb3RvX3ZpZXdfY29tcGlsZXInO1xuXG5leHBvcnQgY29uc3QgVklFV19KSVRfSU1QT1JUUyA9IENPTlNUX0VYUFIoe1xuICAnQXBwVmlldyc6IEFwcFZpZXcsXG4gICdBcHBFbGVtZW50JzogQXBwRWxlbWVudCxcbiAgJ2ZsYXR0ZW5OZXN0ZWRWaWV3UmVuZGVyTm9kZXMnOiBmbGF0dGVuTmVzdGVkVmlld1JlbmRlck5vZGVzLFxuICAnY2hlY2tTbG90Q291bnQnOiBjaGVja1Nsb3RDb3VudFxufSk7XG5cblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFZpZXdDb21waWxlciB7XG4gIGNvbnN0cnVjdG9yKCkge31cblxuICBjb21waWxlQ29tcG9uZW50UnVudGltZShjb21wb25lbnQ6IENvbXBpbGVEaXJlY3RpdmVNZXRhZGF0YSwgdGVtcGxhdGU6IFRlbXBsYXRlQXN0W10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlczogQXJyYXk8c3RyaW5nIHwgYW55W10+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBwcm90b1ZpZXdzOiBDb21waWxlUHJvdG9WaWV3PEFwcFByb3RvVmlldywgQXBwUHJvdG9FbGVtZW50PltdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3RvckZhY3RvcmllczogRnVuY3Rpb25bXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Vmlld0ZhY3Rvcnk6IEZ1bmN0aW9uKTogRnVuY3Rpb24ge1xuICAgIHZhciB2aWV3RmFjdG9yeSA9IG5ldyBSdW50aW1lVmlld0ZhY3RvcnkoY29tcG9uZW50LCBzdHlsZXMsIHByb3RvVmlld3MsIGNoYW5nZURldGVjdG9yRmFjdG9yaWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Vmlld0ZhY3RvcnkpO1xuICAgIHJldHVybiB2aWV3RmFjdG9yeS5jcmVhdGVWaWV3RmFjdG9yeSh0ZW1wbGF0ZSwgMCwgW10pO1xuICB9XG5cbiAgY29tcGlsZUNvbXBvbmVudENvZGVHZW4oY29tcG9uZW50OiBDb21waWxlRGlyZWN0aXZlTWV0YWRhdGEsIHRlbXBsYXRlOiBUZW1wbGF0ZUFzdFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZXM6IFNvdXJjZUV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHByb3RvVmlld3M6IENvbXBpbGVQcm90b1ZpZXc8RXhwcmVzc2lvbiwgRXhwcmVzc2lvbj5bXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0b3JGYWN0b3J5RXhwcmVzc2lvbnM6IFNvdXJjZUV4cHJlc3Npb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRWaWV3RmFjdG9yeTogRnVuY3Rpb24pOiBTb3VyY2VFeHByZXNzaW9uIHtcbiAgICB2YXIgdmlld0ZhY3RvcnkgPSBuZXcgQ29kZUdlblZpZXdGYWN0b3J5KFxuICAgICAgICBjb21wb25lbnQsIHN0eWxlcywgcHJvdG9WaWV3cywgY2hhbmdlRGV0ZWN0b3JGYWN0b3J5RXhwcmVzc2lvbnMsIGNvbXBvbmVudFZpZXdGYWN0b3J5KTtcbiAgICB2YXIgdGFyZ2V0U3RhdGVtZW50czogU3RhdGVtZW50W10gPSBbXTtcbiAgICB2YXIgdmlld0ZhY3RvcnlFeHByZXNzaW9uID0gdmlld0ZhY3RvcnkuY3JlYXRlVmlld0ZhY3RvcnkodGVtcGxhdGUsIDAsIHRhcmdldFN0YXRlbWVudHMpO1xuICAgIHJldHVybiBuZXcgU291cmNlRXhwcmVzc2lvbih0YXJnZXRTdGF0ZW1lbnRzLm1hcChzdG10ID0+IHN0bXQuc3RhdGVtZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld0ZhY3RvcnlFeHByZXNzaW9uLmV4cHJlc3Npb24pO1xuICB9XG59XG5cbmludGVyZmFjZSBWaWV3RmFjdG9yeTxFWFBSRVNTSU9OLCBTVEFURU1FTlQ+IHtcbiAgY3JlYXRlVGV4dChyZW5kZXJlcjogRVhQUkVTU0lPTiwgcGFyZW50OiBFWFBSRVNTSU9OLCB0ZXh0OiBzdHJpbmcsXG4gICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU1RBVEVNRU5UW10pOiBFWFBSRVNTSU9OO1xuXG4gIGNyZWF0ZUVsZW1lbnQocmVuZGVyZXI6IEVYUFJFU1NJT04sIHBhcmVudDogRVhQUkVTU0lPTiwgbmFtZTogc3RyaW5nLCByb290U2VsZWN0b3I6IEVYUFJFU1NJT04sXG4gICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU1RBVEVNRU5UW10pOiBFWFBSRVNTSU9OO1xuXG4gIGNyZWF0ZVRlbXBsYXRlQW5jaG9yKHJlbmRlcmVyOiBFWFBSRVNTSU9OLCBwYXJlbnQ6IEVYUFJFU1NJT04sXG4gICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlbWVudHM6IFNUQVRFTUVOVFtdKTogRVhQUkVTU0lPTjtcblxuICBjcmVhdGVHbG9iYWxFdmVudExpc3RlbmVyKHJlbmRlcmVyOiBFWFBSRVNTSU9OLCB2aWV3OiBFWFBSRVNTSU9OLCBib3VuZEVsZW1lbnRJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50QXN0OiBCb3VuZEV2ZW50QXN0LCB0YXJnZXRTdGF0ZW1lbnRzOiBTVEFURU1FTlRbXSk6IEVYUFJFU1NJT047XG5cbiAgY3JlYXRlRWxlbWVudEV2ZW50TGlzdGVuZXIocmVuZGVyZXI6IEVYUFJFU1NJT04sIHZpZXc6IEVYUFJFU1NJT04sIGJvdW5kRWxlbWVudEluZGV4OiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlck5vZGU6IEVYUFJFU1NJT04sIGV2ZW50QXN0OiBCb3VuZEV2ZW50QXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTVEFURU1FTlRbXSk6IEVYUFJFU1NJT047XG5cbiAgc2V0RWxlbWVudEF0dHJpYnV0ZShyZW5kZXJlcjogRVhQUkVTU0lPTiwgcmVuZGVyTm9kZTogRVhQUkVTU0lPTiwgYXR0ck5hbWU6IHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICBhdHRyVmFsdWU6IHN0cmluZywgdGFyZ2V0U3RhdGVtZW50czogU1RBVEVNRU5UW10pO1xuXG4gIGNyZWF0ZUFwcEVsZW1lbnQoYXBwUHJvdG9FbDogRVhQUkVTU0lPTiwgdmlldzogRVhQUkVTU0lPTiwgcmVuZGVyTm9kZTogRVhQUkVTU0lPTixcbiAgICAgICAgICAgICAgICAgICBwYXJlbnRBcHBFbDogRVhQUkVTU0lPTiwgZW1iZWRkZWRWaWV3RmFjdG9yeTogRVhQUkVTU0lPTixcbiAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTVEFURU1FTlRbXSk6IEVYUFJFU1NJT047XG5cbiAgY3JlYXRlQW5kU2V0Q29tcG9uZW50VmlldyhyZW5kZXJlcjogRVhQUkVTU0lPTiwgdmlld01hbmFnZXI6IEVYUFJFU1NJT04sIHZpZXc6IEVYUFJFU1NJT04sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwRWw6IEVYUFJFU1NJT04sIGNvbXBvbmVudDogQ29tcGlsZURpcmVjdGl2ZU1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnROb2Rlc0J5TmdDb250ZW50SW5kZXg6IEVYUFJFU1NJT05bXVtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlbWVudHM6IFNUQVRFTUVOVFtdKTtcblxuICBnZXRQcm9qZWN0ZWROb2Rlcyhwcm9qZWN0YWJsZU5vZGVzOiBFWFBSRVNTSU9OLCBuZ0NvbnRlbnRJbmRleDogbnVtYmVyKTogRVhQUkVTU0lPTjtcblxuICBhcHBlbmRQcm9qZWN0ZWROb2RlcyhyZW5kZXJlcjogRVhQUkVTU0lPTiwgcGFyZW50OiBFWFBSRVNTSU9OLCBub2RlczogRVhQUkVTU0lPTixcbiAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU1RBVEVNRU5UW10pO1xuXG4gIGNyZWF0ZVZpZXdGYWN0b3J5KGFzdHM6IFRlbXBsYXRlQXN0W10sIGVtYmVkZGVkVGVtcGxhdGVJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTVEFURU1FTlRbXSk6IEVYUFJFU1NJT047XG59XG5cbmNsYXNzIENvZGVHZW5WaWV3RmFjdG9yeSBpbXBsZW1lbnRzIFZpZXdGYWN0b3J5PEV4cHJlc3Npb24sIFN0YXRlbWVudD4ge1xuICBwcml2YXRlIF9uZXh0VmFySWQ6IG51bWJlciA9IDA7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb21wb25lbnQ6IENvbXBpbGVEaXJlY3RpdmVNZXRhZGF0YSwgcHVibGljIHN0eWxlczogU291cmNlRXhwcmVzc2lvbixcbiAgICAgICAgICAgICAgcHVibGljIHByb3RvVmlld3M6IENvbXBpbGVQcm90b1ZpZXc8RXhwcmVzc2lvbiwgRXhwcmVzc2lvbj5bXSxcbiAgICAgICAgICAgICAgcHVibGljIGNoYW5nZURldGVjdG9yRXhwcmVzc2lvbnM6IFNvdXJjZUV4cHJlc3Npb25zLFxuICAgICAgICAgICAgICBwdWJsaWMgY29tcG9uZW50Vmlld0ZhY3Rvcnk6IEZ1bmN0aW9uKSB7fVxuXG4gIHByaXZhdGUgX25leHRWYXIocHJlZml4OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtwcmVmaXh9JHt0aGlzLl9uZXh0VmFySWQrK31fJHt0aGlzLmNvbXBvbmVudC50eXBlLm5hbWV9YDtcbiAgfVxuXG4gIHByaXZhdGUgX25leHRSZW5kZXJWYXIoKTogc3RyaW5nIHsgcmV0dXJuIHRoaXMuX25leHRWYXIoJ3JlbmRlcicpOyB9XG5cbiAgcHJpdmF0ZSBfbmV4dEFwcFZhcigpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5fbmV4dFZhcignYXBwJyk7IH1cblxuICBwcml2YXRlIF9uZXh0RGlzcG9zYWJsZVZhcigpOiBzdHJpbmcge1xuICAgIHJldHVybiBgZGlzcG9zYWJsZSR7dGhpcy5fbmV4dFZhcklkKyt9XyR7dGhpcy5jb21wb25lbnQudHlwZS5uYW1lfWA7XG4gIH1cblxuICBjcmVhdGVUZXh0KHJlbmRlcmVyOiBFeHByZXNzaW9uLCBwYXJlbnQ6IEV4cHJlc3Npb24sIHRleHQ6IHN0cmluZyxcbiAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTdGF0ZW1lbnRbXSk6IEV4cHJlc3Npb24ge1xuICAgIHZhciB2YXJOYW1lID0gdGhpcy5fbmV4dFJlbmRlclZhcigpO1xuICAgIHZhciBzdGF0ZW1lbnQgPVxuICAgICAgICBgdmFyICR7dmFyTmFtZX0gPSAke3JlbmRlcmVyLmV4cHJlc3Npb259LmNyZWF0ZVRleHQoJHtpc1ByZXNlbnQocGFyZW50KSA/IHBhcmVudC5leHByZXNzaW9uIDogbnVsbH0sICR7ZXNjYXBlU2luZ2xlUXVvdGVTdHJpbmcodGV4dCl9KTtgO1xuICAgIHRhcmdldFN0YXRlbWVudHMucHVzaChuZXcgU3RhdGVtZW50KHN0YXRlbWVudCkpO1xuICAgIHJldHVybiBuZXcgRXhwcmVzc2lvbih2YXJOYW1lKTtcbiAgfVxuXG4gIGNyZWF0ZUVsZW1lbnQocmVuZGVyZXI6IEV4cHJlc3Npb24sIHBhcmVudFJlbmRlck5vZGU6IEV4cHJlc3Npb24sIG5hbWU6IHN0cmluZyxcbiAgICAgICAgICAgICAgICByb290U2VsZWN0b3I6IEV4cHJlc3Npb24sIHRhcmdldFN0YXRlbWVudHM6IFN0YXRlbWVudFtdKTogRXhwcmVzc2lvbiB7XG4gICAgdmFyIHZhck5hbWUgPSB0aGlzLl9uZXh0UmVuZGVyVmFyKCk7XG4gICAgdmFyIHZhbHVlRXhwcjtcbiAgICBpZiAoaXNQcmVzZW50KHJvb3RTZWxlY3RvcikpIHtcbiAgICAgIHZhbHVlRXhwciA9IGAke3Jvb3RTZWxlY3Rvci5leHByZXNzaW9ufSA9PSBudWxsID9cbiAgICAgICAgJHtyZW5kZXJlci5leHByZXNzaW9ufS5jcmVhdGVFbGVtZW50KCR7aXNQcmVzZW50KHBhcmVudFJlbmRlck5vZGUpID8gcGFyZW50UmVuZGVyTm9kZS5leHByZXNzaW9uIDogbnVsbH0sICR7ZXNjYXBlU2luZ2xlUXVvdGVTdHJpbmcobmFtZSl9KSA6XG4gICAgICAgICR7cmVuZGVyZXIuZXhwcmVzc2lvbn0uc2VsZWN0Um9vdEVsZW1lbnQoJHtyb290U2VsZWN0b3IuZXhwcmVzc2lvbn0pO2A7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlRXhwciA9XG4gICAgICAgICAgYCR7cmVuZGVyZXIuZXhwcmVzc2lvbn0uY3JlYXRlRWxlbWVudCgke2lzUHJlc2VudChwYXJlbnRSZW5kZXJOb2RlKSA/IHBhcmVudFJlbmRlck5vZGUuZXhwcmVzc2lvbiA6IG51bGx9LCAke2VzY2FwZVNpbmdsZVF1b3RlU3RyaW5nKG5hbWUpfSlgO1xuICAgIH1cbiAgICB2YXIgc3RhdGVtZW50ID0gYHZhciAke3Zhck5hbWV9ID0gJHt2YWx1ZUV4cHJ9O2A7XG4gICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKG5ldyBTdGF0ZW1lbnQoc3RhdGVtZW50KSk7XG4gICAgcmV0dXJuIG5ldyBFeHByZXNzaW9uKHZhck5hbWUpO1xuICB9XG5cbiAgY3JlYXRlVGVtcGxhdGVBbmNob3IocmVuZGVyZXI6IEV4cHJlc3Npb24sIHBhcmVudFJlbmRlck5vZGU6IEV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlbWVudHM6IFN0YXRlbWVudFtdKTogRXhwcmVzc2lvbiB7XG4gICAgdmFyIHZhck5hbWUgPSB0aGlzLl9uZXh0UmVuZGVyVmFyKCk7XG4gICAgdmFyIHZhbHVlRXhwciA9XG4gICAgICAgIGAke3JlbmRlcmVyLmV4cHJlc3Npb259LmNyZWF0ZVRlbXBsYXRlQW5jaG9yKCR7aXNQcmVzZW50KHBhcmVudFJlbmRlck5vZGUpID8gcGFyZW50UmVuZGVyTm9kZS5leHByZXNzaW9uIDogbnVsbH0pO2A7XG4gICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKG5ldyBTdGF0ZW1lbnQoYHZhciAke3Zhck5hbWV9ID0gJHt2YWx1ZUV4cHJ9YCkpO1xuICAgIHJldHVybiBuZXcgRXhwcmVzc2lvbih2YXJOYW1lKTtcbiAgfVxuXG4gIGNyZWF0ZUdsb2JhbEV2ZW50TGlzdGVuZXIocmVuZGVyZXI6IEV4cHJlc3Npb24sIGFwcFZpZXc6IEV4cHJlc3Npb24sIGJvdW5kRWxlbWVudEluZGV4OiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRBc3Q6IEJvdW5kRXZlbnRBc3QsIHRhcmdldFN0YXRlbWVudHM6IFN0YXRlbWVudFtdKTogRXhwcmVzc2lvbiB7XG4gICAgdmFyIGRpc3Bvc2FibGVWYXIgPSB0aGlzLl9uZXh0RGlzcG9zYWJsZVZhcigpO1xuICAgIHZhciBldmVudEhhbmRsZXJFeHByID0gY29kZUdlbkV2ZW50SGFuZGxlcihhcHBWaWV3LCBib3VuZEVsZW1lbnRJbmRleCwgZXZlbnRBc3QuZnVsbE5hbWUpO1xuICAgIHRhcmdldFN0YXRlbWVudHMucHVzaChuZXcgU3RhdGVtZW50KFxuICAgICAgICBgdmFyICR7ZGlzcG9zYWJsZVZhcn0gPSAke3JlbmRlcmVyLmV4cHJlc3Npb259Lmxpc3Rlbkdsb2JhbCgke2VzY2FwZVZhbHVlKGV2ZW50QXN0LnRhcmdldCl9LCAke2VzY2FwZVZhbHVlKGV2ZW50QXN0Lm5hbWUpfSwgJHtldmVudEhhbmRsZXJFeHByfSk7YCkpO1xuICAgIHJldHVybiBuZXcgRXhwcmVzc2lvbihkaXNwb3NhYmxlVmFyKTtcbiAgfVxuXG4gIGNyZWF0ZUVsZW1lbnRFdmVudExpc3RlbmVyKHJlbmRlcmVyOiBFeHByZXNzaW9uLCBhcHBWaWV3OiBFeHByZXNzaW9uLCBib3VuZEVsZW1lbnRJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJOb2RlOiBFeHByZXNzaW9uLCBldmVudEFzdDogQm91bmRFdmVudEFzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU3RhdGVtZW50W10pIHtcbiAgICB2YXIgZGlzcG9zYWJsZVZhciA9IHRoaXMuX25leHREaXNwb3NhYmxlVmFyKCk7XG4gICAgdmFyIGV2ZW50SGFuZGxlckV4cHIgPSBjb2RlR2VuRXZlbnRIYW5kbGVyKGFwcFZpZXcsIGJvdW5kRWxlbWVudEluZGV4LCBldmVudEFzdC5mdWxsTmFtZSk7XG4gICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKG5ldyBTdGF0ZW1lbnQoXG4gICAgICAgIGB2YXIgJHtkaXNwb3NhYmxlVmFyfSA9ICR7cmVuZGVyZXIuZXhwcmVzc2lvbn0ubGlzdGVuKCR7cmVuZGVyTm9kZS5leHByZXNzaW9ufSwgJHtlc2NhcGVWYWx1ZShldmVudEFzdC5uYW1lKX0sICR7ZXZlbnRIYW5kbGVyRXhwcn0pO2ApKTtcbiAgICByZXR1cm4gbmV3IEV4cHJlc3Npb24oZGlzcG9zYWJsZVZhcik7XG4gIH1cblxuICBzZXRFbGVtZW50QXR0cmlidXRlKHJlbmRlcmVyOiBFeHByZXNzaW9uLCByZW5kZXJOb2RlOiBFeHByZXNzaW9uLCBhdHRyTmFtZTogc3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgIGF0dHJWYWx1ZTogc3RyaW5nLCB0YXJnZXRTdGF0ZW1lbnRzOiBTdGF0ZW1lbnRbXSkge1xuICAgIHRhcmdldFN0YXRlbWVudHMucHVzaChuZXcgU3RhdGVtZW50KFxuICAgICAgICBgJHtyZW5kZXJlci5leHByZXNzaW9ufS5zZXRFbGVtZW50QXR0cmlidXRlKCR7cmVuZGVyTm9kZS5leHByZXNzaW9ufSwgJHtlc2NhcGVTaW5nbGVRdW90ZVN0cmluZyhhdHRyTmFtZSl9LCAke2VzY2FwZVNpbmdsZVF1b3RlU3RyaW5nKGF0dHJWYWx1ZSl9KTtgKSk7XG4gIH1cblxuICBjcmVhdGVBcHBFbGVtZW50KGFwcFByb3RvRWw6IEV4cHJlc3Npb24sIGFwcFZpZXc6IEV4cHJlc3Npb24sIHJlbmRlck5vZGU6IEV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgcGFyZW50QXBwRWw6IEV4cHJlc3Npb24sIGVtYmVkZGVkVmlld0ZhY3Rvcnk6IEV4cHJlc3Npb24sXG4gICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU3RhdGVtZW50W10pOiBFeHByZXNzaW9uIHtcbiAgICB2YXIgYXBwVmFyID0gdGhpcy5fbmV4dEFwcFZhcigpO1xuICAgIHZhciB2YXJWYWx1ZSA9XG4gICAgICAgIGBuZXcgJHtBUFBfRUxfTU9EVUxFX1JFRn1BcHBFbGVtZW50KCR7YXBwUHJvdG9FbC5leHByZXNzaW9ufSwgJHthcHBWaWV3LmV4cHJlc3Npb259LFxuICAgICAgJHtpc1ByZXNlbnQocGFyZW50QXBwRWwpID8gcGFyZW50QXBwRWwuZXhwcmVzc2lvbiA6IG51bGx9LCAke3JlbmRlck5vZGUuZXhwcmVzc2lvbn0sICR7aXNQcmVzZW50KGVtYmVkZGVkVmlld0ZhY3RvcnkpID8gZW1iZWRkZWRWaWV3RmFjdG9yeS5leHByZXNzaW9uIDogbnVsbH0pYDtcbiAgICB0YXJnZXRTdGF0ZW1lbnRzLnB1c2gobmV3IFN0YXRlbWVudChgdmFyICR7YXBwVmFyfSA9ICR7dmFyVmFsdWV9O2ApKTtcbiAgICByZXR1cm4gbmV3IEV4cHJlc3Npb24oYXBwVmFyKTtcbiAgfVxuXG4gIGNyZWF0ZUFuZFNldENvbXBvbmVudFZpZXcocmVuZGVyZXI6IEV4cHJlc3Npb24sIHZpZXdNYW5hZ2VyOiBFeHByZXNzaW9uLCB2aWV3OiBFeHByZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcEVsOiBFeHByZXNzaW9uLCBjb21wb25lbnQ6IENvbXBpbGVEaXJlY3RpdmVNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4OiBFeHByZXNzaW9uW11bXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTdGF0ZW1lbnRbXSkge1xuICAgIHZhciBjb2RlR2VuQ29udGVudE5vZGVzO1xuICAgIGlmICh0aGlzLmNvbXBvbmVudC50eXBlLmlzSG9zdCkge1xuICAgICAgY29kZUdlbkNvbnRlbnROb2RlcyA9IGAke3ZpZXcuZXhwcmVzc2lvbn0ucHJvamVjdGFibGVOb2Rlc2A7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvZGVHZW5Db250ZW50Tm9kZXMgPVxuICAgICAgICAgIGBbJHtjb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4Lm1hcCggbm9kZXMgPT4gY29kZUdlbkZsYXRBcnJheShub2RlcykgKS5qb2luKCcsJyl9XWA7XG4gICAgfVxuICAgIHRhcmdldFN0YXRlbWVudHMucHVzaChuZXcgU3RhdGVtZW50KFxuICAgICAgICBgJHt0aGlzLmNvbXBvbmVudFZpZXdGYWN0b3J5KGNvbXBvbmVudCl9KCR7cmVuZGVyZXIuZXhwcmVzc2lvbn0sICR7dmlld01hbmFnZXIuZXhwcmVzc2lvbn0sICR7YXBwRWwuZXhwcmVzc2lvbn0sICR7Y29kZUdlbkNvbnRlbnROb2Rlc30sIG51bGwsIG51bGwsIG51bGwpO2ApKTtcbiAgfVxuXG4gIGdldFByb2plY3RlZE5vZGVzKHByb2plY3RhYmxlTm9kZXM6IEV4cHJlc3Npb24sIG5nQ29udGVudEluZGV4OiBudW1iZXIpOiBFeHByZXNzaW9uIHtcbiAgICByZXR1cm4gbmV3IEV4cHJlc3Npb24oYCR7cHJvamVjdGFibGVOb2Rlcy5leHByZXNzaW9ufVske25nQ29udGVudEluZGV4fV1gLCB0cnVlKTtcbiAgfVxuXG4gIGFwcGVuZFByb2plY3RlZE5vZGVzKHJlbmRlcmVyOiBFeHByZXNzaW9uLCBwYXJlbnQ6IEV4cHJlc3Npb24sIG5vZGVzOiBFeHByZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBTdGF0ZW1lbnRbXSkge1xuICAgIHRhcmdldFN0YXRlbWVudHMucHVzaChuZXcgU3RhdGVtZW50KFxuICAgICAgICBgJHtyZW5kZXJlci5leHByZXNzaW9ufS5wcm9qZWN0Tm9kZXMoJHtwYXJlbnQuZXhwcmVzc2lvbn0sICR7QVBQX1ZJRVdfTU9EVUxFX1JFRn1mbGF0dGVuTmVzdGVkVmlld1JlbmRlck5vZGVzKCR7bm9kZXMuZXhwcmVzc2lvbn0pKTtgKSk7XG4gIH1cblxuICBjcmVhdGVWaWV3RmFjdG9yeShhc3RzOiBUZW1wbGF0ZUFzdFtdLCBlbWJlZGRlZFRlbXBsYXRlSW5kZXg6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogU3RhdGVtZW50W10pOiBFeHByZXNzaW9uIHtcbiAgICB2YXIgY29tcGlsZVByb3RvVmlldyA9IHRoaXMucHJvdG9WaWV3c1tlbWJlZGRlZFRlbXBsYXRlSW5kZXhdO1xuICAgIHZhciBpc0hvc3RWaWV3ID0gdGhpcy5jb21wb25lbnQudHlwZS5pc0hvc3Q7XG4gICAgdmFyIGlzQ29tcG9uZW50VmlldyA9IGVtYmVkZGVkVGVtcGxhdGVJbmRleCA9PT0gMCAmJiAhaXNIb3N0VmlldztcbiAgICB2YXIgdmlzaXRvciA9IG5ldyBWaWV3QnVpbGRlclZpc2l0b3I8RXhwcmVzc2lvbiwgU3RhdGVtZW50PihcbiAgICAgICAgbmV3IEV4cHJlc3Npb24oJ3JlbmRlcmVyJyksIG5ldyBFeHByZXNzaW9uKCd2aWV3TWFuYWdlcicpLFxuICAgICAgICBuZXcgRXhwcmVzc2lvbigncHJvamVjdGFibGVOb2RlcycpLCBpc0hvc3RWaWV3ID8gbmV3IEV4cHJlc3Npb24oJ3Jvb3RTZWxlY3RvcicpIDogbnVsbCxcbiAgICAgICAgbmV3IEV4cHJlc3Npb24oJ3ZpZXcnKSwgY29tcGlsZVByb3RvVmlldywgdGFyZ2V0U3RhdGVtZW50cywgdGhpcyk7XG5cbiAgICB0ZW1wbGF0ZVZpc2l0QWxsKFxuICAgICAgICB2aXNpdG9yLCBhc3RzLFxuICAgICAgICBuZXcgUGFyZW50RWxlbWVudChpc0NvbXBvbmVudFZpZXcgPyBuZXcgRXhwcmVzc2lvbigncGFyZW50UmVuZGVyTm9kZScpIDogbnVsbCwgbnVsbCwgbnVsbCkpO1xuXG4gICAgdmFyIGFwcFByb3RvVmlldyA9IGNvbXBpbGVQcm90b1ZpZXcucHJvdG9WaWV3LmV4cHJlc3Npb247XG4gICAgdmFyIHZpZXdGYWN0b3J5TmFtZSA9IGNvZGVHZW5WaWV3RmFjdG9yeU5hbWUodGhpcy5jb21wb25lbnQsIGVtYmVkZGVkVGVtcGxhdGVJbmRleCk7XG4gICAgdmFyIGNoYW5nZURldGVjdG9yRmFjdG9yeSA9IHRoaXMuY2hhbmdlRGV0ZWN0b3JFeHByZXNzaW9ucy5leHByZXNzaW9uc1tlbWJlZGRlZFRlbXBsYXRlSW5kZXhdO1xuICAgIHZhciBmYWN0b3J5QXJncyA9IFtcbiAgICAgICdwYXJlbnRSZW5kZXJlcicsXG4gICAgICAndmlld01hbmFnZXInLFxuICAgICAgJ2NvbnRhaW5lckVsJyxcbiAgICAgICdwcm9qZWN0YWJsZU5vZGVzJyxcbiAgICAgICdyb290U2VsZWN0b3InLFxuICAgICAgJ2R5bmFtaWNhbGx5Q3JlYXRlZFByb3ZpZGVycycsXG4gICAgICAncm9vdEluamVjdG9yJ1xuICAgIF07XG4gICAgdmFyIGluaXRSZW5kZXJlclN0bXRzID0gW107XG4gICAgdmFyIHJlbmRlcmVyRXhwciA9IGBwYXJlbnRSZW5kZXJlcmA7XG4gICAgaWYgKGVtYmVkZGVkVGVtcGxhdGVJbmRleCA9PT0gMCkge1xuICAgICAgdmFyIHJlbmRlckNvbXBUeXBlVmFyID0gdGhpcy5fbmV4dFZhcigncmVuZGVyVHlwZScpO1xuICAgICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKG5ldyBTdGF0ZW1lbnQoYHZhciAke3JlbmRlckNvbXBUeXBlVmFyfSA9IG51bGw7YCkpO1xuICAgICAgdmFyIHN0eWxlc1ZhciA9IHRoaXMuX25leHRWYXIoJ3N0eWxlcycpO1xuICAgICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKFxuICAgICAgICAgIG5ldyBTdGF0ZW1lbnQoYCR7Q09OU1RfVkFSfSAke3N0eWxlc1Zhcn0gPSAke3RoaXMuc3R5bGVzLmV4cHJlc3Npb259O2ApKTtcbiAgICAgIHZhciBlbmNhcHN1bGF0aW9uID0gdGhpcy5jb21wb25lbnQudGVtcGxhdGUuZW5jYXBzdWxhdGlvbjtcbiAgICAgIGluaXRSZW5kZXJlclN0bXRzLnB1c2goYGlmICgke3JlbmRlckNvbXBUeXBlVmFyfSA9PSBudWxsKSB7XG4gICAgICAgICR7cmVuZGVyQ29tcFR5cGVWYXJ9ID0gdmlld01hbmFnZXIuY3JlYXRlUmVuZGVyQ29tcG9uZW50VHlwZSgke2NvZGVHZW5WaWV3RW5jYXBzdWxhdGlvbihlbmNhcHN1bGF0aW9uKX0sICR7c3R5bGVzVmFyfSk7XG4gICAgICB9YCk7XG4gICAgICByZW5kZXJlckV4cHIgPSBgcGFyZW50UmVuZGVyZXIucmVuZGVyQ29tcG9uZW50KCR7cmVuZGVyQ29tcFR5cGVWYXJ9KWA7XG4gICAgfVxuICAgIHZhciBzdGF0ZW1lbnQgPSBgXG4ke2NvZGVHZW5GbkhlYWRlcihmYWN0b3J5QXJncywgdmlld0ZhY3RvcnlOYW1lKX17XG4gICR7aW5pdFJlbmRlcmVyU3RtdHMuam9pbignXFxuJyl9XG4gIHZhciByZW5kZXJlciA9ICR7cmVuZGVyZXJFeHByfTtcbiAgdmFyIHZpZXcgPSBuZXcgJHtBUFBfVklFV19NT0RVTEVfUkVGfUFwcFZpZXcoXG4gICAgJHthcHBQcm90b1ZpZXd9LCByZW5kZXJlciwgdmlld01hbmFnZXIsXG4gICAgcHJvamVjdGFibGVOb2RlcyxcbiAgICBjb250YWluZXJFbCxcbiAgICBkeW5hbWljYWxseUNyZWF0ZWRQcm92aWRlcnMsIHJvb3RJbmplY3RvcixcbiAgICAke2NoYW5nZURldGVjdG9yRmFjdG9yeX0oKVxuICApO1xuICAke0FQUF9WSUVXX01PRFVMRV9SRUZ9Y2hlY2tTbG90Q291bnQoJHtlc2NhcGVWYWx1ZSh0aGlzLmNvbXBvbmVudC50eXBlLm5hbWUpfSwgJHt0aGlzLmNvbXBvbmVudC50ZW1wbGF0ZS5uZ0NvbnRlbnRTZWxlY3RvcnMubGVuZ3RofSwgcHJvamVjdGFibGVOb2Rlcyk7XG4gICR7aXNDb21wb25lbnRWaWV3ID8gJ3ZhciBwYXJlbnRSZW5kZXJOb2RlID0gcmVuZGVyZXIuY3JlYXRlVmlld1Jvb3Qodmlldy5jb250YWluZXJBcHBFbGVtZW50Lm5hdGl2ZUVsZW1lbnQpOycgOiAnJ31cbiAgJHt2aXNpdG9yLnJlbmRlclN0bXRzLm1hcChzdG10ID0+IHN0bXQuc3RhdGVtZW50KS5qb2luKCdcXG4nKX1cbiAgJHt2aXNpdG9yLmFwcFN0bXRzLm1hcChzdG10ID0+IHN0bXQuc3RhdGVtZW50KS5qb2luKCdcXG4nKX1cblxuICB2aWV3LmluaXQoJHtjb2RlR2VuRmxhdEFycmF5KHZpc2l0b3Iucm9vdE5vZGVzT3JBcHBFbGVtZW50cyl9LCAke2NvZGVHZW5BcnJheSh2aXNpdG9yLnJlbmRlck5vZGVzKX0sICR7Y29kZUdlbkFycmF5KHZpc2l0b3IuYXBwRGlzcG9zYWJsZXMpfSxcbiAgICAgICAgICAgICR7Y29kZUdlbkFycmF5KHZpc2l0b3IuYXBwRWxlbWVudHMpfSk7XG4gIHJldHVybiB2aWV3O1xufWA7XG4gICAgdGFyZ2V0U3RhdGVtZW50cy5wdXNoKG5ldyBTdGF0ZW1lbnQoc3RhdGVtZW50KSk7XG4gICAgcmV0dXJuIG5ldyBFeHByZXNzaW9uKHZpZXdGYWN0b3J5TmFtZSk7XG4gIH1cbn1cblxuY2xhc3MgUnVudGltZVZpZXdGYWN0b3J5IGltcGxlbWVudHMgVmlld0ZhY3Rvcnk8YW55LCBhbnk+IHtcbiAgY29uc3RydWN0b3IocHVibGljIGNvbXBvbmVudDogQ29tcGlsZURpcmVjdGl2ZU1ldGFkYXRhLCBwdWJsaWMgc3R5bGVzOiBBcnJheTxzdHJpbmcgfCBhbnlbXT4sXG4gICAgICAgICAgICAgIHB1YmxpYyBwcm90b1ZpZXdzOiBDb21waWxlUHJvdG9WaWV3PEFwcFByb3RvVmlldywgQXBwUHJvdG9FbGVtZW50PltdLFxuICAgICAgICAgICAgICBwdWJsaWMgY2hhbmdlRGV0ZWN0b3JGYWN0b3JpZXM6IEZ1bmN0aW9uW10sIHB1YmxpYyBjb21wb25lbnRWaWV3RmFjdG9yeTogRnVuY3Rpb24pIHt9XG5cbiAgY3JlYXRlVGV4dChyZW5kZXJlcjogUmVuZGVyZXIsIHBhcmVudDogYW55LCB0ZXh0OiBzdHJpbmcsIHRhcmdldFN0YXRlbWVudHM6IGFueVtdKTogYW55IHtcbiAgICByZXR1cm4gcmVuZGVyZXIuY3JlYXRlVGV4dChwYXJlbnQsIHRleHQpO1xuICB9XG5cbiAgY3JlYXRlRWxlbWVudChyZW5kZXJlcjogUmVuZGVyZXIsIHBhcmVudDogYW55LCBuYW1lOiBzdHJpbmcsIHJvb3RTZWxlY3Rvcjogc3RyaW5nLFxuICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlbWVudHM6IGFueVtdKTogYW55IHtcbiAgICB2YXIgZWw7XG4gICAgaWYgKGlzUHJlc2VudChyb290U2VsZWN0b3IpKSB7XG4gICAgICBlbCA9IHJlbmRlcmVyLnNlbGVjdFJvb3RFbGVtZW50KHJvb3RTZWxlY3Rvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsID0gcmVuZGVyZXIuY3JlYXRlRWxlbWVudChwYXJlbnQsIG5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gZWw7XG4gIH1cblxuICBjcmVhdGVUZW1wbGF0ZUFuY2hvcihyZW5kZXJlcjogUmVuZGVyZXIsIHBhcmVudDogYW55LCB0YXJnZXRTdGF0ZW1lbnRzOiBhbnlbXSk6IGFueSB7XG4gICAgcmV0dXJuIHJlbmRlcmVyLmNyZWF0ZVRlbXBsYXRlQW5jaG9yKHBhcmVudCk7XG4gIH1cblxuICBjcmVhdGVHbG9iYWxFdmVudExpc3RlbmVyKHJlbmRlcmVyOiBSZW5kZXJlciwgYXBwVmlldzogQXBwVmlldywgYm91bmRFbGVtZW50SW5kZXg6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudEFzdDogQm91bmRFdmVudEFzdCwgdGFyZ2V0U3RhdGVtZW50czogYW55W10pOiBhbnkge1xuICAgIHJldHVybiByZW5kZXJlci5saXN0ZW5HbG9iYWwoXG4gICAgICAgIGV2ZW50QXN0LnRhcmdldCwgZXZlbnRBc3QubmFtZSxcbiAgICAgICAgKGV2ZW50KSA9PiBhcHBWaWV3LnRyaWdnZXJFdmVudEhhbmRsZXJzKGV2ZW50QXN0LmZ1bGxOYW1lLCBldmVudCwgYm91bmRFbGVtZW50SW5kZXgpKTtcbiAgfVxuXG4gIGNyZWF0ZUVsZW1lbnRFdmVudExpc3RlbmVyKHJlbmRlcmVyOiBSZW5kZXJlciwgYXBwVmlldzogQXBwVmlldywgYm91bmRFbGVtZW50SW5kZXg6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyTm9kZTogYW55LCBldmVudEFzdDogQm91bmRFdmVudEFzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGVtZW50czogYW55W10pOiBhbnkge1xuICAgIHJldHVybiByZW5kZXJlci5saXN0ZW4oXG4gICAgICAgIHJlbmRlck5vZGUsIGV2ZW50QXN0Lm5hbWUsXG4gICAgICAgIChldmVudCkgPT4gYXBwVmlldy50cmlnZ2VyRXZlbnRIYW5kbGVycyhldmVudEFzdC5mdWxsTmFtZSwgZXZlbnQsIGJvdW5kRWxlbWVudEluZGV4KSk7XG4gIH1cblxuICBzZXRFbGVtZW50QXR0cmlidXRlKHJlbmRlcmVyOiBSZW5kZXJlciwgcmVuZGVyTm9kZTogYW55LCBhdHRyTmFtZTogc3RyaW5nLCBhdHRyVmFsdWU6IHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBhbnlbXSkge1xuICAgIHJlbmRlcmVyLnNldEVsZW1lbnRBdHRyaWJ1dGUocmVuZGVyTm9kZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSk7XG4gIH1cblxuICBjcmVhdGVBcHBFbGVtZW50KGFwcFByb3RvRWw6IEFwcFByb3RvRWxlbWVudCwgYXBwVmlldzogQXBwVmlldywgcmVuZGVyTm9kZTogYW55LFxuICAgICAgICAgICAgICAgICAgIHBhcmVudEFwcEVsOiBBcHBFbGVtZW50LCBlbWJlZGRlZFZpZXdGYWN0b3J5OiBGdW5jdGlvbixcbiAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBhbnlbXSk6IGFueSB7XG4gICAgcmV0dXJuIG5ldyBBcHBFbGVtZW50KGFwcFByb3RvRWwsIGFwcFZpZXcsIHBhcmVudEFwcEVsLCByZW5kZXJOb2RlLCBlbWJlZGRlZFZpZXdGYWN0b3J5KTtcbiAgfVxuXG4gIGNyZWF0ZUFuZFNldENvbXBvbmVudFZpZXcocmVuZGVyZXI6IFJlbmRlcmVyLCB2aWV3TWFuYWdlcjogQXBwVmlld01hbmFnZXJfLCBhcHBWaWV3OiBBcHBWaWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcEVsOiBBcHBFbGVtZW50LCBjb21wb25lbnQ6IENvbXBpbGVEaXJlY3RpdmVNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4OiBBcnJheTxBcnJheTxhbnkgfCBhbnlbXT4+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlbWVudHM6IGFueVtdKSB7XG4gICAgdmFyIGZsYXR0ZW5lZENvbnRlbnROb2RlcztcbiAgICBpZiAodGhpcy5jb21wb25lbnQudHlwZS5pc0hvc3QpIHtcbiAgICAgIGZsYXR0ZW5lZENvbnRlbnROb2RlcyA9IGFwcFZpZXcucHJvamVjdGFibGVOb2RlcztcbiAgICB9IGVsc2Uge1xuICAgICAgZmxhdHRlbmVkQ29udGVudE5vZGVzID0gTGlzdFdyYXBwZXIuY3JlYXRlRml4ZWRTaXplKGNvbnRlbnROb2Rlc0J5TmdDb250ZW50SW5kZXgubGVuZ3RoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29udGVudE5vZGVzQnlOZ0NvbnRlbnRJbmRleC5sZW5ndGg7IGkrKykge1xuICAgICAgICBmbGF0dGVuZWRDb250ZW50Tm9kZXNbaV0gPSBmbGF0dGVuQXJyYXkoY29udGVudE5vZGVzQnlOZ0NvbnRlbnRJbmRleFtpXSwgW10pO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmNvbXBvbmVudFZpZXdGYWN0b3J5KGNvbXBvbmVudCkocmVuZGVyZXIsIHZpZXdNYW5hZ2VyLCBhcHBFbCwgZmxhdHRlbmVkQ29udGVudE5vZGVzKTtcbiAgfVxuXG4gIGdldFByb2plY3RlZE5vZGVzKHByb2plY3RhYmxlTm9kZXM6IGFueVtdW10sIG5nQ29udGVudEluZGV4OiBudW1iZXIpOiBhbnlbXSB7XG4gICAgcmV0dXJuIHByb2plY3RhYmxlTm9kZXNbbmdDb250ZW50SW5kZXhdO1xuICB9XG5cbiAgYXBwZW5kUHJvamVjdGVkTm9kZXMocmVuZGVyZXI6IFJlbmRlcmVyLCBwYXJlbnQ6IGFueSwgbm9kZXM6IGFueVtdLCB0YXJnZXRTdGF0ZW1lbnRzOiBhbnlbXSkge1xuICAgIHJlbmRlcmVyLnByb2plY3ROb2RlcyhwYXJlbnQsIGZsYXR0ZW5OZXN0ZWRWaWV3UmVuZGVyTm9kZXMobm9kZXMpKTtcbiAgfVxuXG4gIGNyZWF0ZVZpZXdGYWN0b3J5KGFzdHM6IFRlbXBsYXRlQXN0W10sIGVtYmVkZGVkVGVtcGxhdGVJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZW1lbnRzOiBhbnlbXSk6IEZ1bmN0aW9uIHtcbiAgICB2YXIgY29tcGlsZVByb3RvVmlldyA9IHRoaXMucHJvdG9WaWV3c1tlbWJlZGRlZFRlbXBsYXRlSW5kZXhdO1xuICAgIHZhciBpc0NvbXBvbmVudFZpZXcgPSBjb21waWxlUHJvdG9WaWV3LnByb3RvVmlldy50eXBlID09PSBWaWV3VHlwZS5DT01QT05FTlQ7XG4gICAgdmFyIHJlbmRlckNvbXBvbmVudFR5cGUgPSBudWxsO1xuICAgIHJldHVybiAocGFyZW50UmVuZGVyZXI6IFBhcmVudFJlbmRlcmVyLCB2aWV3TWFuYWdlcjogQXBwVmlld01hbmFnZXJfLCBjb250YWluZXJFbDogQXBwRWxlbWVudCxcbiAgICAgICAgICAgIHByb2plY3RhYmxlTm9kZXM6IGFueVtdW10sIHJvb3RTZWxlY3Rvcjogc3RyaW5nID0gbnVsbCxcbiAgICAgICAgICAgIGR5bmFtaWNhbGx5Q3JlYXRlZFByb3ZpZGVyczogUmVzb2x2ZWRQcm92aWRlcltdID0gbnVsbCxcbiAgICAgICAgICAgIHJvb3RJbmplY3RvcjogSW5qZWN0b3IgPSBudWxsKSA9PiB7XG4gICAgICBjaGVja1Nsb3RDb3VudCh0aGlzLmNvbXBvbmVudC50eXBlLm5hbWUsIHRoaXMuY29tcG9uZW50LnRlbXBsYXRlLm5nQ29udGVudFNlbGVjdG9ycy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICBwcm9qZWN0YWJsZU5vZGVzKTtcbiAgICAgIHZhciByZW5kZXJlcjtcbiAgICAgIGlmIChlbWJlZGRlZFRlbXBsYXRlSW5kZXggPT09IDApIHtcbiAgICAgICAgaWYgKGlzQmxhbmsocmVuZGVyQ29tcG9uZW50VHlwZSkpIHtcbiAgICAgICAgICByZW5kZXJDb21wb25lbnRUeXBlID0gdmlld01hbmFnZXIuY3JlYXRlUmVuZGVyQ29tcG9uZW50VHlwZShcbiAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnQudGVtcGxhdGUuZW5jYXBzdWxhdGlvbiwgdGhpcy5zdHlsZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJlbmRlcmVyID0gcGFyZW50UmVuZGVyZXIucmVuZGVyQ29tcG9uZW50KHJlbmRlckNvbXBvbmVudFR5cGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyZXIgPSA8UmVuZGVyZXI+cGFyZW50UmVuZGVyZXI7XG4gICAgICB9XG4gICAgICB2YXIgY2hhbmdlRGV0ZWN0b3IgPSB0aGlzLmNoYW5nZURldGVjdG9yRmFjdG9yaWVzW2VtYmVkZGVkVGVtcGxhdGVJbmRleF0oKTtcbiAgICAgIHZhciB2aWV3ID1cbiAgICAgICAgICBuZXcgQXBwVmlldyhjb21waWxlUHJvdG9WaWV3LnByb3RvVmlldywgcmVuZGVyZXIsIHZpZXdNYW5hZ2VyLCBwcm9qZWN0YWJsZU5vZGVzLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lckVsLCBkeW5hbWljYWxseUNyZWF0ZWRQcm92aWRlcnMsIHJvb3RJbmplY3RvciwgY2hhbmdlRGV0ZWN0b3IpO1xuICAgICAgdmFyIHZpc2l0b3IgPSBuZXcgVmlld0J1aWxkZXJWaXNpdG9yPGFueSwgYW55PihcbiAgICAgICAgICByZW5kZXJlciwgdmlld01hbmFnZXIsIHByb2plY3RhYmxlTm9kZXMsIHJvb3RTZWxlY3RvciwgdmlldywgY29tcGlsZVByb3RvVmlldywgW10sIHRoaXMpO1xuICAgICAgdmFyIHBhcmVudFJlbmRlck5vZGUgPVxuICAgICAgICAgIGlzQ29tcG9uZW50VmlldyA/IHJlbmRlcmVyLmNyZWF0ZVZpZXdSb290KGNvbnRhaW5lckVsLm5hdGl2ZUVsZW1lbnQpIDogbnVsbDtcbiAgICAgIHRlbXBsYXRlVmlzaXRBbGwodmlzaXRvciwgYXN0cywgbmV3IFBhcmVudEVsZW1lbnQocGFyZW50UmVuZGVyTm9kZSwgbnVsbCwgbnVsbCkpO1xuICAgICAgdmlldy5pbml0KGZsYXR0ZW5BcnJheSh2aXNpdG9yLnJvb3ROb2Rlc09yQXBwRWxlbWVudHMsIFtdKSwgdmlzaXRvci5yZW5kZXJOb2RlcyxcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmFwcERpc3Bvc2FibGVzLCB2aXNpdG9yLmFwcEVsZW1lbnRzKTtcbiAgICAgIHJldHVybiB2aWV3O1xuICAgIH07XG4gIH1cbn1cblxuY2xhc3MgUGFyZW50RWxlbWVudDxFWFBSRVNTSU9OPiB7XG4gIHB1YmxpYyBjb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4OiBBcnJheTxFWFBSRVNTSU9OPltdO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyByZW5kZXJOb2RlOiBFWFBSRVNTSU9OLCBwdWJsaWMgYXBwRWw6IEVYUFJFU1NJT04sXG4gICAgICAgICAgICAgIHB1YmxpYyBjb21wb25lbnQ6IENvbXBpbGVEaXJlY3RpdmVNZXRhZGF0YSkge1xuICAgIGlmIChpc1ByZXNlbnQoY29tcG9uZW50KSkge1xuICAgICAgdGhpcy5jb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4ID1cbiAgICAgICAgICBMaXN0V3JhcHBlci5jcmVhdGVGaXhlZFNpemUoY29tcG9uZW50LnRlbXBsYXRlLm5nQ29udGVudFNlbGVjdG9ycy5sZW5ndGgpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbnRlbnROb2Rlc0J5TmdDb250ZW50SW5kZXgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5jb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4W2ldID0gW107XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29udGVudE5vZGVzQnlOZ0NvbnRlbnRJbmRleCA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgYWRkQ29udGVudE5vZGUobmdDb250ZW50SW5kZXg6IG51bWJlciwgbm9kZUV4cHI6IEVYUFJFU1NJT04pIHtcbiAgICB0aGlzLmNvbnRlbnROb2Rlc0J5TmdDb250ZW50SW5kZXhbbmdDb250ZW50SW5kZXhdLnB1c2gobm9kZUV4cHIpO1xuICB9XG59XG5cbmNsYXNzIFZpZXdCdWlsZGVyVmlzaXRvcjxFWFBSRVNTSU9OLCBTVEFURU1FTlQ+IGltcGxlbWVudHMgVGVtcGxhdGVBc3RWaXNpdG9yIHtcbiAgcmVuZGVyU3RtdHM6IEFycmF5PFNUQVRFTUVOVD4gPSBbXTtcbiAgcmVuZGVyTm9kZXM6IEVYUFJFU1NJT05bXSA9IFtdO1xuICBhcHBTdG10czogQXJyYXk8U1RBVEVNRU5UPiA9IFtdO1xuICBhcHBFbGVtZW50czogRVhQUkVTU0lPTltdID0gW107XG4gIGFwcERpc3Bvc2FibGVzOiBFWFBSRVNTSU9OW10gPSBbXTtcblxuICByb290Tm9kZXNPckFwcEVsZW1lbnRzOiBFWFBSRVNTSU9OW10gPSBbXTtcblxuICBlbGVtZW50Q291bnQ6IG51bWJlciA9IDA7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHJlbmRlcmVyOiBFWFBSRVNTSU9OLCBwdWJsaWMgdmlld01hbmFnZXI6IEVYUFJFU1NJT04sXG4gICAgICAgICAgICAgIHB1YmxpYyBwcm9qZWN0YWJsZU5vZGVzOiBFWFBSRVNTSU9OLCBwdWJsaWMgcm9vdFNlbGVjdG9yOiBFWFBSRVNTSU9OLFxuICAgICAgICAgICAgICBwdWJsaWMgdmlldzogRVhQUkVTU0lPTiwgcHVibGljIHByb3RvVmlldzogQ29tcGlsZVByb3RvVmlldzxFWFBSRVNTSU9OLCBFWFBSRVNTSU9OPixcbiAgICAgICAgICAgICAgcHVibGljIHRhcmdldFN0YXRlbWVudHM6IFNUQVRFTUVOVFtdLFxuICAgICAgICAgICAgICBwdWJsaWMgZmFjdG9yeTogVmlld0ZhY3Rvcnk8RVhQUkVTU0lPTiwgU1RBVEVNRU5UPikge31cblxuICBwcml2YXRlIF9hZGRSZW5kZXJOb2RlKHJlbmRlck5vZGU6IEVYUFJFU1NJT04sIGFwcEVsOiBFWFBSRVNTSU9OLCBuZ0NvbnRlbnRJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogUGFyZW50RWxlbWVudDxFWFBSRVNTSU9OPikge1xuICAgIHRoaXMucmVuZGVyTm9kZXMucHVzaChyZW5kZXJOb2RlKTtcbiAgICBpZiAoaXNQcmVzZW50KHBhcmVudC5jb21wb25lbnQpKSB7XG4gICAgICBpZiAoaXNQcmVzZW50KG5nQ29udGVudEluZGV4KSkge1xuICAgICAgICBwYXJlbnQuYWRkQ29udGVudE5vZGUobmdDb250ZW50SW5kZXgsIGlzUHJlc2VudChhcHBFbCkgPyBhcHBFbCA6IHJlbmRlck5vZGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNCbGFuayhwYXJlbnQucmVuZGVyTm9kZSkpIHtcbiAgICAgIHRoaXMucm9vdE5vZGVzT3JBcHBFbGVtZW50cy5wdXNoKGlzUHJlc2VudChhcHBFbCkgPyBhcHBFbCA6IHJlbmRlck5vZGUpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2dldFBhcmVudFJlbmRlck5vZGUobmdDb250ZW50SW5kZXg6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IFBhcmVudEVsZW1lbnQ8RVhQUkVTU0lPTj4pOiBFWFBSRVNTSU9OIHtcbiAgICByZXR1cm4gaXNQcmVzZW50KHBhcmVudC5jb21wb25lbnQpICYmXG4gICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXBvbmVudC50ZW1wbGF0ZS5lbmNhcHN1bGF0aW9uICE9PSBWaWV3RW5jYXBzdWxhdGlvbi5OYXRpdmUgP1xuICAgICAgICAgICAgICAgbnVsbCA6XG4gICAgICAgICAgICAgICBwYXJlbnQucmVuZGVyTm9kZTtcbiAgfVxuXG4gIHZpc2l0Qm91bmRUZXh0KGFzdDogQm91bmRUZXh0QXN0LCBwYXJlbnQ6IFBhcmVudEVsZW1lbnQ8RVhQUkVTU0lPTj4pOiBhbnkge1xuICAgIHJldHVybiB0aGlzLl92aXNpdFRleHQoJycsIGFzdC5uZ0NvbnRlbnRJbmRleCwgcGFyZW50KTtcbiAgfVxuICB2aXNpdFRleHQoYXN0OiBUZXh0QXN0LCBwYXJlbnQ6IFBhcmVudEVsZW1lbnQ8RVhQUkVTU0lPTj4pOiBhbnkge1xuICAgIHJldHVybiB0aGlzLl92aXNpdFRleHQoYXN0LnZhbHVlLCBhc3QubmdDb250ZW50SW5kZXgsIHBhcmVudCk7XG4gIH1cbiAgcHJpdmF0ZSBfdmlzaXRUZXh0KHZhbHVlOiBzdHJpbmcsIG5nQ29udGVudEluZGV4OiBudW1iZXIsIHBhcmVudDogUGFyZW50RWxlbWVudDxFWFBSRVNTSU9OPikge1xuICAgIHZhciByZW5kZXJOb2RlID0gdGhpcy5mYWN0b3J5LmNyZWF0ZVRleHQoXG4gICAgICAgIHRoaXMucmVuZGVyZXIsIHRoaXMuX2dldFBhcmVudFJlbmRlck5vZGUobmdDb250ZW50SW5kZXgsIHBhcmVudCksIHZhbHVlLCB0aGlzLnJlbmRlclN0bXRzKTtcbiAgICB0aGlzLl9hZGRSZW5kZXJOb2RlKHJlbmRlck5vZGUsIG51bGwsIG5nQ29udGVudEluZGV4LCBwYXJlbnQpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmlzaXROZ0NvbnRlbnQoYXN0OiBOZ0NvbnRlbnRBc3QsIHBhcmVudDogUGFyZW50RWxlbWVudDxFWFBSRVNTSU9OPik6IGFueSB7XG4gICAgdmFyIG5vZGVzRXhwcmVzc2lvbiA9IHRoaXMuZmFjdG9yeS5nZXRQcm9qZWN0ZWROb2Rlcyh0aGlzLnByb2plY3RhYmxlTm9kZXMsIGFzdC5pbmRleCk7XG4gICAgaWYgKGlzUHJlc2VudChwYXJlbnQuY29tcG9uZW50KSkge1xuICAgICAgaWYgKGlzUHJlc2VudChhc3QubmdDb250ZW50SW5kZXgpKSB7XG4gICAgICAgIHBhcmVudC5hZGRDb250ZW50Tm9kZShhc3QubmdDb250ZW50SW5kZXgsIG5vZGVzRXhwcmVzc2lvbik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpc1ByZXNlbnQocGFyZW50LnJlbmRlck5vZGUpKSB7XG4gICAgICAgIHRoaXMuZmFjdG9yeS5hcHBlbmRQcm9qZWN0ZWROb2Rlcyh0aGlzLnJlbmRlcmVyLCBwYXJlbnQucmVuZGVyTm9kZSwgbm9kZXNFeHByZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJTdG10cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJvb3ROb2Rlc09yQXBwRWxlbWVudHMucHVzaChub2Rlc0V4cHJlc3Npb24pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHZpc2l0RWxlbWVudChhc3Q6IEVsZW1lbnRBc3QsIHBhcmVudDogUGFyZW50RWxlbWVudDxFWFBSRVNTSU9OPik6IGFueSB7XG4gICAgdmFyIHJlbmRlck5vZGUgPSB0aGlzLmZhY3RvcnkuY3JlYXRlRWxlbWVudChcbiAgICAgICAgdGhpcy5yZW5kZXJlciwgdGhpcy5fZ2V0UGFyZW50UmVuZGVyTm9kZShhc3QubmdDb250ZW50SW5kZXgsIHBhcmVudCksIGFzdC5uYW1lLFxuICAgICAgICB0aGlzLnJvb3RTZWxlY3RvciwgdGhpcy5yZW5kZXJTdG10cyk7XG5cbiAgICB2YXIgY29tcG9uZW50ID0gYXN0LmdldENvbXBvbmVudCgpO1xuICAgIHZhciBlbGVtZW50SW5kZXggPSB0aGlzLmVsZW1lbnRDb3VudCsrO1xuICAgIHZhciBwcm90b0VsID0gdGhpcy5wcm90b1ZpZXcucHJvdG9FbGVtZW50c1tlbGVtZW50SW5kZXhdO1xuXG4gICAgcHJvdG9FbC5yZW5kZXJFdmVudHMuZm9yRWFjaCgoZXZlbnRBc3QpID0+IHtcbiAgICAgIHZhciBkaXNwb3NhYmxlO1xuICAgICAgaWYgKGlzUHJlc2VudChldmVudEFzdC50YXJnZXQpKSB7XG4gICAgICAgIGRpc3Bvc2FibGUgPSB0aGlzLmZhY3RvcnkuY3JlYXRlR2xvYmFsRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIsIHRoaXMudmlldywgcHJvdG9FbC5ib3VuZEVsZW1lbnRJbmRleCwgZXZlbnRBc3QsIHRoaXMucmVuZGVyU3RtdHMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGlzcG9zYWJsZSA9IHRoaXMuZmFjdG9yeS5jcmVhdGVFbGVtZW50RXZlbnRMaXN0ZW5lcih0aGlzLnJlbmRlcmVyLCB0aGlzLnZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9FbC5ib3VuZEVsZW1lbnRJbmRleCwgcmVuZGVyTm9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudEFzdCwgdGhpcy5yZW5kZXJTdG10cyk7XG4gICAgICB9XG4gICAgICB0aGlzLmFwcERpc3Bvc2FibGVzLnB1c2goZGlzcG9zYWJsZSk7XG4gICAgfSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm90b0VsLmF0dHJOYW1lQW5kVmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgYXR0ck5hbWUgPSBwcm90b0VsLmF0dHJOYW1lQW5kVmFsdWVzW2ldWzBdO1xuICAgICAgdmFyIGF0dHJWYWx1ZSA9IHByb3RvRWwuYXR0ck5hbWVBbmRWYWx1ZXNbaV1bMV07XG4gICAgICB0aGlzLmZhY3Rvcnkuc2V0RWxlbWVudEF0dHJpYnV0ZSh0aGlzLnJlbmRlcmVyLCByZW5kZXJOb2RlLCBhdHRyTmFtZSwgYXR0clZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJTdG10cyk7XG4gICAgfVxuICAgIHZhciBhcHBFbCA9IG51bGw7XG4gICAgaWYgKGlzUHJlc2VudChwcm90b0VsLmFwcFByb3RvRWwpKSB7XG4gICAgICBhcHBFbCA9IHRoaXMuZmFjdG9yeS5jcmVhdGVBcHBFbGVtZW50KHByb3RvRWwuYXBwUHJvdG9FbCwgdGhpcy52aWV3LCByZW5kZXJOb2RlLCBwYXJlbnQuYXBwRWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsIHRoaXMuYXBwU3RtdHMpO1xuICAgICAgdGhpcy5hcHBFbGVtZW50cy5wdXNoKGFwcEVsKTtcbiAgICB9XG4gICAgdGhpcy5fYWRkUmVuZGVyTm9kZShyZW5kZXJOb2RlLCBhcHBFbCwgYXN0Lm5nQ29udGVudEluZGV4LCBwYXJlbnQpO1xuXG4gICAgdmFyIG5ld1BhcmVudCA9IG5ldyBQYXJlbnRFbGVtZW50PEVYUFJFU1NJT04+KFxuICAgICAgICByZW5kZXJOb2RlLCBpc1ByZXNlbnQoYXBwRWwpID8gYXBwRWwgOiBwYXJlbnQuYXBwRWwsIGNvbXBvbmVudCk7XG4gICAgdGVtcGxhdGVWaXNpdEFsbCh0aGlzLCBhc3QuY2hpbGRyZW4sIG5ld1BhcmVudCk7XG4gICAgaWYgKGlzUHJlc2VudChhcHBFbCkgJiYgaXNQcmVzZW50KGNvbXBvbmVudCkpIHtcbiAgICAgIHRoaXMuZmFjdG9yeS5jcmVhdGVBbmRTZXRDb21wb25lbnRWaWV3KHRoaXMucmVuZGVyZXIsIHRoaXMudmlld01hbmFnZXIsIHRoaXMudmlldywgYXBwRWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQsIG5ld1BhcmVudC5jb250ZW50Tm9kZXNCeU5nQ29udGVudEluZGV4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBTdG10cyk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmlzaXRFbWJlZGRlZFRlbXBsYXRlKGFzdDogRW1iZWRkZWRUZW1wbGF0ZUFzdCwgcGFyZW50OiBQYXJlbnRFbGVtZW50PEVYUFJFU1NJT04+KTogYW55IHtcbiAgICB2YXIgcmVuZGVyTm9kZSA9IHRoaXMuZmFjdG9yeS5jcmVhdGVUZW1wbGF0ZUFuY2hvcihcbiAgICAgICAgdGhpcy5yZW5kZXJlciwgdGhpcy5fZ2V0UGFyZW50UmVuZGVyTm9kZShhc3QubmdDb250ZW50SW5kZXgsIHBhcmVudCksIHRoaXMucmVuZGVyU3RtdHMpO1xuXG4gICAgdmFyIGVsZW1lbnRJbmRleCA9IHRoaXMuZWxlbWVudENvdW50Kys7XG4gICAgdmFyIHByb3RvRWwgPSB0aGlzLnByb3RvVmlldy5wcm90b0VsZW1lbnRzW2VsZW1lbnRJbmRleF07XG4gICAgdmFyIGVtYmVkZGVkVmlld0ZhY3RvcnkgPSB0aGlzLmZhY3RvcnkuY3JlYXRlVmlld0ZhY3RvcnkoXG4gICAgICAgIGFzdC5jaGlsZHJlbiwgcHJvdG9FbC5lbWJlZGRlZFRlbXBsYXRlSW5kZXgsIHRoaXMudGFyZ2V0U3RhdGVtZW50cyk7XG5cbiAgICB2YXIgYXBwRWwgPSB0aGlzLmZhY3RvcnkuY3JlYXRlQXBwRWxlbWVudChwcm90b0VsLmFwcFByb3RvRWwsIHRoaXMudmlldywgcmVuZGVyTm9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYXBwRWwsIGVtYmVkZGVkVmlld0ZhY3RvcnksIHRoaXMuYXBwU3RtdHMpO1xuICAgIHRoaXMuX2FkZFJlbmRlck5vZGUocmVuZGVyTm9kZSwgYXBwRWwsIGFzdC5uZ0NvbnRlbnRJbmRleCwgcGFyZW50KTtcbiAgICB0aGlzLmFwcEVsZW1lbnRzLnB1c2goYXBwRWwpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmlzaXRWYXJpYWJsZShhc3Q6IFZhcmlhYmxlQXN0LCBjdHg6IGFueSk6IGFueSB7IHJldHVybiBudWxsOyB9XG4gIHZpc2l0QXR0cihhc3Q6IEF0dHJBc3QsIGN0eDogYW55KTogYW55IHsgcmV0dXJuIG51bGw7IH1cbiAgdmlzaXREaXJlY3RpdmUoYXN0OiBEaXJlY3RpdmVBc3QsIGN0eDogYW55KTogYW55IHsgcmV0dXJuIG51bGw7IH1cbiAgdmlzaXRFdmVudChhc3Q6IEJvdW5kRXZlbnRBc3QsIGN0eDogYW55KTogYW55IHsgcmV0dXJuIG51bGw7IH1cbiAgdmlzaXREaXJlY3RpdmVQcm9wZXJ0eShhc3Q6IEJvdW5kRGlyZWN0aXZlUHJvcGVydHlBc3QsIGNvbnRleHQ6IGFueSk6IGFueSB7IHJldHVybiBudWxsOyB9XG4gIHZpc2l0RWxlbWVudFByb3BlcnR5KGFzdDogQm91bmRFbGVtZW50UHJvcGVydHlBc3QsIGNvbnRleHQ6IGFueSk6IGFueSB7IHJldHVybiBudWxsOyB9XG59XG5cblxuZnVuY3Rpb24gY29kZUdlbkV2ZW50SGFuZGxlcih2aWV3OiBFeHByZXNzaW9uLCBib3VuZEVsZW1lbnRJbmRleDogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBjb2RlR2VuVmFsdWVGbihcbiAgICAgIFsnZXZlbnQnXSxcbiAgICAgIGAke3ZpZXcuZXhwcmVzc2lvbn0udHJpZ2dlckV2ZW50SGFuZGxlcnMoJHtlc2NhcGVWYWx1ZShldmVudE5hbWUpfSwgZXZlbnQsICR7Ym91bmRFbGVtZW50SW5kZXh9KWApO1xufVxuXG5mdW5jdGlvbiBjb2RlR2VuVmlld0ZhY3RvcnlOYW1lKGNvbXBvbmVudDogQ29tcGlsZURpcmVjdGl2ZU1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWJlZGRlZFRlbXBsYXRlSW5kZXg6IG51bWJlcik6IHN0cmluZyB7XG4gIHJldHVybiBgdmlld0ZhY3RvcnlfJHtjb21wb25lbnQudHlwZS5uYW1lfSR7ZW1iZWRkZWRUZW1wbGF0ZUluZGV4fWA7XG59XG5cbmZ1bmN0aW9uIGNvZGVHZW5WaWV3RW5jYXBzdWxhdGlvbih2YWx1ZTogVmlld0VuY2Fwc3VsYXRpb24pOiBzdHJpbmcge1xuICBpZiAoSVNfREFSVCkge1xuICAgIHJldHVybiBgJHtNRVRBREFUQV9NT0RVTEVfUkVGfSR7dmFsdWV9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYCR7dmFsdWV9YDtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
